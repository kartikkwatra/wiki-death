!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=20)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=a(n(15)),o=a(n(14));function a(t){return t&&t.__esModule?t:{default:t}}e.default={people:function(t){var e=t.map(function(t,e){return i({},t,{index:e,display:t.display.replace(/\(.*\)/g,"").trim(),link:"https://en.wikipedia.org"+t.link,extract_truncated:(0,o.default)({text:t.extract,chars:235,clean:!0,ellipses:!0}),mean_views_adjusted_bd_1:+t.mean_views_adjusted_bd_1,mean_views_adjusted_bd_2:+t.mean_views_adjusted_bd_2,median_views_adjusted_bd_2:+t.median_views_adjusted_bd_2,death_views_2:+t.death_views_2,death_views_adjusted_2:+t.death_views_adjusted_2,thumbnail_width:+t.thumbnail_width,thumbnail_height:+t.thumbnail_height,year_of_birth:+t.year_of_birth,year_of_death:+t.year_of_death,iqr_1:+t.iqr_1,std_1:+t.std_1,industry:t.industry.split(",").map(function(t){return t.trim()}),cause:[t.cause.trim()],perspective_show:!!t.perspective_show})}),n=e.filter(function(t){return!t.industry[0].length});return n.length&&console.log({missing:n}),e},pageview:function(t){return t.map(function(t){return i({},t,{pageid:t.pageid||"beyonce",bin:+t.bin,bin_death_index:+t.bin_death_index,views:+t.views,views_adjusted:+t.views_adjusted,date:(0,r.default)(t.timestamp)})})},ma:function(t){return t.map(function(t){return i({},t,{pageid:t.pageid,bin_death_index:+t.bin_death_index,ma:+t.ma,diff:+t.diff,diff_percent:+t.diff_percent,diff_views:+t.diff_views,diff_percent_views:+t.diff_percent_views})})}}},function(t,e,n){"use strict";n.r(e);var i="http://www.w3.org/1999/xhtml",r={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},o=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),r.hasOwnProperty(e)?{space:r[e],local:t}:t},a=function(t){var e=o(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===i&&e.documentElement.namespaceURI===i?e.createElement(t):e.createElementNS(n,t)}})(e)},s=0;function c(){this._="@"+(++s).toString(36)}c.prototype=function(){return new c}.prototype={constructor:c,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var u=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var l=document.documentElement;if(!l.matches){var f=l.webkitMatchesSelector||l.msMatchesSelector||l.mozMatchesSelector||l.oMatchesSelector;u=function(t){return function(){return f.call(this,t)}}}}var h=u,d={},p=null;function _(t,e,n){return t=y(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function y(t,e,n){return function(i){var r=p;p=i;try{t.call(this,this.__data__,e,n)}finally{p=r}}}function v(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function g(t,e,n){var i=d.hasOwnProperty(t.type)?_:y;return function(r,o,a){var s,c=this.__on,u=i(e,o,a);if(c)for(var l=0,f=c.length;l<f;++l)if((s=c[l]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},c?c.push(s):this.__on=[s]}}function m(t,e,n,i){var r=p;t.sourceEvent=p,p=t;try{return e.apply(n,i)}finally{p=r}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(d={mouseenter:"mouseover",mouseleave:"mouseout"}));var x=function(){for(var t,e=p;t=e.sourceEvent;)e=t;return e},b=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]},w=function(t){var e=x();return e.changedTouches&&(e=e.changedTouches[0]),b(t,e)};function j(){}var M=function(t){return null==t?j:function(){return this.querySelector(t)}};function k(){return[]}var A=function(t){return new Array(t.length)};function O(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}O.prototype={constructor:O,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var S="$";function T(t,e,n,i,r,o){for(var a,s=0,c=e.length,u=o.length;s<u;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new O(t,o[s]);for(;s<c;++s)(a=e[s])&&(r[s]=a)}function E(t,e,n,i,r,o,a){var s,c,u,l={},f=e.length,h=o.length,d=new Array(f);for(s=0;s<f;++s)(c=e[s])&&(d[s]=u=S+a.call(c,c.__data__,s,e),u in l?r[s]=c:l[u]=c);for(s=0;s<h;++s)(c=l[u=S+a.call(t,o[s],s,o)])?(i[s]=c,c.__data__=o[s],l[u]=null):n[s]=new O(t,o[s]);for(s=0;s<f;++s)(c=e[s])&&l[d[s]]===c&&(r[s]=c)}function P(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var N=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function C(t){return t.trim().split(/^|\s+/)}function L(t){return t.classList||new R(t)}function R(t){this._node=t,this._names=C(t.getAttribute("class")||"")}function B(t,e){for(var n=L(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function I(t,e){for(var n=L(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Y(){this.textContent=""}function X(){this.innerHTML=""}function D(){this.nextSibling&&this.parentNode.appendChild(this)}function z(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function q(){return null}function H(){var t=this.parentNode;t&&t.removeChild(this)}function W(t,e,n){var i=N(t),r=i.CustomEvent;r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}R.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var F=[null];function V(t,e){this._groups=t,this._parents=e}V.prototype=function(){return new V([[document.documentElement]],F)}.prototype={constructor:V,select:function(t){"function"!=typeof t&&(t=M(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a,s=e[r],c=s.length,u=i[r]=new Array(c),l=0;l<c;++l)(o=s[l])&&(a=t.call(o,o.__data__,l,s))&&("__data__"in o&&(a.__data__=o.__data__),u[l]=a);return new V(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=function(t){return null==t?k:function(){return this.querySelectorAll(t)}}(t));for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var a,s=e[o],c=s.length,u=0;u<c;++u)(a=s[u])&&(i.push(t.call(a,a.__data__,u,s)),r.push(a));return new V(i,r)},filter:function(t){"function"!=typeof t&&(t=h(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,c=i[r]=[],u=0;u<s;++u)(o=a[u])&&t.call(o,o.__data__,u,a)&&c.push(o);return new V(i,this._parents)},data:function(t,e){if(!t)return d=new Array(this.size()),u=-1,this.each(function(t){d[++u]=t}),d;var n=e?E:T,i=this._parents,r=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=r.length,a=new Array(o),s=new Array(o),c=new Array(o),u=0;u<o;++u){var l=i[u],f=r[u],h=f.length,d=t.call(l,l&&l.__data__,u,i),p=d.length,_=s[u]=new Array(p),y=a[u]=new Array(p);n(l,f,_,y,c[u]=new Array(h),d,e);for(var v,g,m=0,x=0;m<p;++m)if(v=_[m]){for(m>=x&&(x=m+1);!(g=y[x])&&++x<p;);v._next=g||null}}return(a=new V(a,i))._enter=s,a._exit=c,a},enter:function(){return new V(this._enter||this._groups.map(A),this._parents)},exit:function(){return new V(this._exit||this._groups.map(A),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var c,u=e[s],l=n[s],f=u.length,h=a[s]=new Array(f),d=0;d<f;++d)(c=u[d]||l[d])&&(h[d]=c);for(;s<i;++s)a[s]=e[s];return new V(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&a!==i.nextSibling&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=P);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],c=s.length,u=r[o]=new Array(c),l=0;l<c;++l)(a=s[l])&&(u[l]=a);u.sort(e)}return new V(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,e){var n=o(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){var i;return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):N(i=this.node()).getComputedStyle(i,null).getPropertyValue(t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=C(t+"");if(arguments.length<2){for(var i=L(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?B:I)(this,t)}}:e?function(t){return function(){B(this,t)}}:function(t){return function(){I(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?Y:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(D)},lower:function(){return this.each(z)},append:function(t){var e="function"==typeof t?t:a(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:a(t),i=null==e?q:"function"==typeof e?e:M(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(H)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?g:v,null==n&&(n=!1),i=0;i<a;++i)this.each(s(o[i],e,n));return this}var s=this.node().__on;if(s)for(var c,u=0,l=s.length;u<l;++u)for(i=0,c=s[u];i<a;++i)if((r=o[i]).type===c.type&&r.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return W(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return W(this,t,e)}})(t,e))}};var $=function(t){return"string"==typeof t?new V([[document.querySelector(t)]],[document.documentElement]):new V([[t]],F)},U=function(t,e,n){arguments.length<3&&(n=e,e=x().changedTouches);for(var i,r=0,o=e?e.length:0;r<o;++r)if((i=e[r]).identifier===n)return b(t,i);return null},G={value:function(){}};function J(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i)throw new Error("illegal type: "+t);i[t]=[]}return new Z(i)}function Z(t){this._=t}function Q(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function K(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=G,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Z.prototype=J.prototype={constructor:Z,on:function(t,e){var n,i=this._,r=function(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}(t+"",i),o=-1,a=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=r[o]).type)i[n]=K(i[n],t.name,e);else if(null==e)for(n in i)i[n]=K(i[n],t.name,null);return this}for(;++o<a;)if((n=(t=r[o]).type)&&(n=Q(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Z(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var tt=J;function et(){p.stopImmediatePropagation()}var nt=function(){p.preventDefault(),p.stopImmediatePropagation()},it=function(t){var e=t.document.documentElement,n=$(t).on("dragstart.drag",nt,!0);"onselectstart"in e?n.on("selectstart.drag",nt,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")},rt=function(t){return function(){return t}};function ot(t,e,n,i,r,o,a,s,c,u){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=o,this.y=a,this.dx=s,this.dy=c,this._=u}function at(){return!p.button}function st(){return this.parentNode}function ct(t){return null==t?{x:p.x,y:p.y}:t}ot.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var ut=function(){var t,e,n=at,i=st,r=ct,o={},a=tt("start","drag","end"),s=0;function c(t){t.on("mousedown.drag",u).on("touchstart.drag",h).on("touchmove.drag",d).on("touchend.drag touchcancel.drag",_).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){if(!e&&n.apply(this,arguments)){var r=y("mouse",i.apply(this,arguments),w,this,arguments);r&&($(p.view).on("mousemove.drag",l,!0).on("mouseup.drag",f,!0),it(p.view),et(),t=!1,r("start"))}}function l(){nt(),t=!0,o.mouse("drag")}function f(){$(p.view).on("mousemove.drag mouseup.drag",null),function(t,e){var n=t.document.documentElement,i=$(t).on("dragstart.drag",null);e&&(i.on("click.drag",nt,!0),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(p.view,t),nt(),o.mouse("end")}function h(){if(n.apply(this,arguments)){var t,e,r=p.changedTouches,o=i.apply(this,arguments),a=r.length;for(t=0;t<a;++t)(e=y(r[t].identifier,o,U,this,arguments))&&(et(),e("start"))}}function d(){var t,e,n=p.changedTouches,i=n.length;for(t=0;t<i;++t)(e=o[n[t].identifier])&&(nt(),e("drag"))}function _(){var t,n,i=p.changedTouches,r=i.length;for(e&&clearTimeout(e),e=setTimeout(function(){e=null},500),t=0;t<r;++t)(n=o[i[t].identifier])&&(et(),n("end"))}function y(t,e,n,i,u){var l,f,h,d=n(e,t),_=a.copy();if(m(new ot(c,"beforestart",l,t,s,d[0],d[1],0,0,_),function(){return null!=(p.subject=l=r.apply(i,u))&&(f=l.x-d[0]||0,h=l.y-d[1]||0,!0)}))return function r(a){var p,y=d;switch(a){case"start":o[t]=r,p=s++;break;case"end":delete o[t],--s;case"drag":d=n(e,t),p=s}m(new ot(c,a,l,t,p,d[0]+f,d[1]+h,d[0]-y[0],d[1]-y[1],_),_.apply,_,[a,i,u])}}return c.filter=function(t){return arguments.length?(n="function"==typeof t?t:rt(!!t),c):n},c.container=function(t){return arguments.length?(i="function"==typeof t?t:rt(t),c):i},c.subject=function(t){return arguments.length?(r="function"==typeof t?t:rt(t),c):r},c.on=function(){var t=a.on.apply(a,arguments);return t===a?c:t},c},lt=Math.PI,ft=2*lt,ht=ft-1e-6;function dt(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function pt(){return new dt}dt.prototype=pt.prototype={constructor:dt,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-t,c=i-e,u=o-t,l=a-e,f=u*u+l*l;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>1e-6)if(Math.abs(l*s-c*u)>1e-6&&r){var h=n-o,d=i-a,p=s*s+c*c,_=h*h+d*d,y=Math.sqrt(p),v=Math.sqrt(f),g=r*Math.tan((lt-Math.acos((p+f-_)/(2*y*v)))/2),m=g/v,x=g/y;Math.abs(m-1)>1e-6&&(this._+="L"+(t+m*u)+","+(e+m*l)),this._+="A"+r+","+r+",0,0,"+ +(l*h>u*d)+","+(this._x1=t+x*s)+","+(this._y1=e+x*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,i,r,o){t=+t,e=+e;var a=(n=+n)*Math.cos(i),s=n*Math.sin(i),c=t+a,u=e+s,l=1^o,f=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-u)>1e-6)&&(this._+="L"+c+","+u),n&&(f<0&&(f=f%ft+ft),f>ht?this._+="A"+n+","+n+",0,1,"+l+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=u):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=lt)+","+l+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var _t=pt,yt=function(t){return function(){return t}},vt=1e-12,gt=Math.PI,mt=gt/2,xt=2*gt;function bt(t){return t.innerRadius}function wt(t){return t.outerRadius}function jt(t){return t.startAngle}function Mt(t){return t.endAngle}function kt(t){return t&&t.padAngle}function At(t){return t>=1?mt:t<=-1?-mt:Math.asin(t)}function Ot(t,e,n,i,r,o,a){var s=t-n,c=e-i,u=(a?o:-o)/Math.sqrt(s*s+c*c),l=u*c,f=-u*s,h=t+l,d=e+f,p=n+l,_=i+f,y=(h+p)/2,v=(d+_)/2,g=p-h,m=_-d,x=g*g+m*m,b=r-o,w=h*_-p*d,j=(m<0?-1:1)*Math.sqrt(Math.max(0,b*b*x-w*w)),M=(w*m-g*j)/x,k=(-w*g-m*j)/x,A=(w*m+g*j)/x,O=(-w*g+m*j)/x,S=M-y,T=k-v,E=A-y,P=O-v;return S*S+T*T>E*E+P*P&&(M=A,k=O),{cx:M,cy:k,x01:-l,y01:-f,x11:M*(r/b-1),y11:k*(r/b-1)}}function St(t){this._context=t}St.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Tt=function(t){return new St(t)};function Et(t){return t[0]}function Pt(t){return t[1]}function Nt(t){this._curve=t}!function(t){function e(e){return new Nt(t(e))}e._curve=t}(Tt),Nt.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}},Math.sqrt(1/3);Math.sin(gt/10),Math.sin(7*gt/10);var Ct=(Math.sin(xt/10),Math.cos(xt/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function Lt(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Rt(t){this._context=t}function Bt(t,e){this._basis=new Rt(t),this._beta=e}function It(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Yt(t,e){this._context=t,this._k=(1-e)/6}function Xt(t,e){this._context=t,this._k=(1-e)/6}function Dt(t,e){this._context=t,this._k=(1-e)/6}function zt(t,e,n){var i=t._x1,r=t._y1,o=t._x2,a=t._y2;if(t._l01_a>vt){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,r=(r*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>vt){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/l,a=(a*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(i,r,o,a,t._x2,t._y2)}function qt(t,e){this._context=t,this._alpha=e}Rt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Lt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Lt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Bt.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,r=t[0],o=e[0],a=t[n]-r,s=e[n]-o,c=-1;++c<=n;)i=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(r+i*a),this._beta*e[c]+(1-this._beta)*(o+i*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}},function t(e){function n(t){return 1===e?new Rt(t):new Bt(t,e)}return n.beta=function(e){return t(+e)},n}(.85),Yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:It(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:It(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return new Yt(t,e)}return n.tension=function(e){return t(+e)},n}(0),Xt.prototype={areaStart:Ct,areaEnd:Ct,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:It(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return new Xt(t,e)}return n.tension=function(e){return t(+e)},n}(0),Dt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:It(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return new Dt(t,e)}return n.tension=function(e){return t(+e)},n}(0),qt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:zt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ht=function t(e){function n(t){return e?new qt(t,e):new Yt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Wt(t,e){this._context=t,this._alpha=e}function Ft(t,e){this._context=t,this._alpha=e}function Vt(t){return t<0?-1:1}function $t(t,e,n){var i=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(i||r<0&&-0),a=(n-t._y1)/(r||i<0&&-0),s=(o*r+a*i)/(i+r);return(Vt(o)+Vt(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Ut(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Gt(t,e,n){var i=t._x0,r=t._y0,o=t._x1,a=t._y1,s=(o-i)/3;t._context.bezierCurveTo(i+s,r+s*e,o-s,a-s*n,o,a)}function Jt(t){this._context=t}function Zt(t){this._context=t}Wt.prototype={areaStart:Ct,areaEnd:Ct,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:zt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return e?new Wt(t,e):new Xt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5),Ft.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zt(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}},function t(e){function n(t){return e?new Ft(t,e):new Dt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5),Jt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Gt(this,this._t0,Ut(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Gt(this,Ut(this,n=$t(this,t,e)),n);break;default:Gt(this,this._t0,n=$t(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(function(t){this._context=new Zt(t)}.prototype=Object.create(Jt.prototype)).point=function(t,e){Jt.prototype.point.call(this,e,t)},Zt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,o){this._context.bezierCurveTo(e,t,i,n,o,r)}},Array.prototype.slice,n.d(e,"annotation",function(){return Ne}),n.d(e,"annotationTypeBase",function(){return ye}),n.d(e,"annotationLabel",function(){return me}),n.d(e,"annotationCallout",function(){return xe}),n.d(e,"annotationCalloutCurve",function(){return we}),n.d(e,"annotationCalloutElbow",function(){return be}),n.d(e,"annotationCalloutCircle",function(){return Me}),n.d(e,"annotationCalloutRect",function(){return ke}),n.d(e,"annotationXYThreshold",function(){return Oe}),n.d(e,"annotationBadge",function(){return je}),n.d(e,"annotationCustomType",function(){return ve});var Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},te=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),ee=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ne=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},ie=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},re=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},oe=function(){function t(e){var n=e.x,i=void 0===n?0:n,r=e.y,o=void 0===r?0:r,a=e.nx,s=e.ny,c=e.dy,u=void 0===c?0:c,l=e.dx,f=void 0===l?0:l,h=e.color,d=void 0===h?"grey":h,p=e.data,_=e.type,y=e.subject,v=e.connector,g=e.note,m=e.disable,x=e.id,b=e.className;Kt(this,t),this._dx=void 0!==a?a-i:f,this._dy=void 0!==s?s-o:u,this._x=i,this._y=o,this._color=d,this.id=x,this._className=b||"",this.type=_||"",this.data=p,this.note=g||{},this.connector=v||{},this.subject=y||{},this.disable=m||[]}return te(t,[{key:"updatePosition",value:function(){this.type.setPosition&&(this.type.setPosition(),this.type.subject&&0!==this.type.subject.selectAll(":not(.handle)").nodes().length&&this.type.redrawSubject())}},{key:"updateOffset",value:function(){this.type.setOffset&&(this.type.setOffset(),0!==this.type.connector.selectAll(":not(.handle)").nodes().length&&this.type.redrawConnector(),this.type.redrawNote())}},{key:"className",get:function(){return this._className},set:function(t){this._className=t,this.type.setClassName&&this.type.setClassName()}},{key:"x",get:function(){return this._x},set:function(t){this._x=t,this.updatePosition()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this.updatePosition()}},{key:"color",get:function(){return this._color},set:function(t){this._color=t,this.updatePosition()}},{key:"dx",get:function(){return this._dx},set:function(t){this._dx=t,this.updateOffset()}},{key:"dy",get:function(){return this._dy},set:function(t){this._dy=t,this.updateOffset()}},{key:"nx",set:function(t){this._dx=t-this._x,this.updateOffset()}},{key:"ny",set:function(t){this._dy=t-this._y,this.updateOffset()}},{key:"offset",get:function(){return{x:this._dx,y:this._dy}},set:function(t){var e=t.x,n=t.y;this._dx=e,this._dy=n,this.updateOffset()}},{key:"position",get:function(){return{x:this._x,y:this._y}},set:function(t){var e=t.x,n=t.y;this._x=e,this._y=n,this.updatePosition()}},{key:"translation",get:function(){return{x:this._x+this._dx,y:this._y+this._dy}}},{key:"json",get:function(){var t={x:this._x,y:this._y,dx:this._dx,dy:this._dy};return this.data&&Object.keys(this.data).length>0&&(t.data=this.data),this.type&&(t.type=this.type),this._className&&(t.className=this._className),Object.keys(this.connector).length>0&&(t.connector=this.connector),Object.keys(this.subject).length>0&&(t.subject=this.subject),Object.keys(this.note).length>0&&(t.note=this.note),t}}]),t}(),ae=function(){function t(e){var n=e.annotations,i=e.accessors,r=e.accessorsInverse;Kt(this,t),this.accessors=i,this.accessorsInverse=r,this.annotations=n}return te(t,[{key:"clearTypes",value:function(t){this.annotations.forEach(function(e){e.type=void 0,e.subject=t&&t.subject||e.subject,e.connector=t&&t.connector||e.connector,e.note=t&&t.note||e.note})}},{key:"setPositionWithAccessors",value:function(){var t=this;this.annotations.forEach(function(e){e.type.setPositionWithAccessors(t.accessors)})}},{key:"editMode",value:function(t){this.annotations.forEach(function(e){e.type&&(e.type.editMode=t,e.type.updateEditMode())})}},{key:"updateDisable",value:function(t){this.annotations.forEach(function(e){e.disable=t,e.type&&t.forEach(function(t){e.type[t]&&(e.type[t].remove&&e.type[t].remove(),e.type[t]=void 0)})})}},{key:"updateTextWrap",value:function(t){this.annotations.forEach(function(e){e.type&&e.type.updateTextWrap&&e.type.updateTextWrap(t)})}},{key:"updateText",value:function(){this.annotations.forEach(function(t){t.type&&t.type.drawText&&t.type.drawText()})}},{key:"updateNotePadding",value:function(t){this.annotations.forEach(function(e){e.type&&(e.type.notePadding=t)})}},{key:"json",get:function(){var t=this;return this.annotations.map(function(e){var n=e.json;return t.accessorsInverse&&e.data&&(n.data={},Object.keys(t.accessorsInverse).forEach(function(i){n.data[i]=t.accessorsInverse[i]({x:e.x,y:e.y})})),n})}},{key:"noteNodes",get:function(){return this.annotations.map(function(t){return ee({},t.type.getNoteBBoxOffset(),{positionX:t.x,positionY:t.y})})}}]),t}(),se=function(t,e){return"dynamic"!==t&&"left"!==t&&"right"!==t||(t=e<0?"top":"bottom"),t},ce=function(t,e){return"dynamic"!==t&&"top"!==t&&"bottom"!==t||(t=e<0?"right":"left"),t},ue=["topBottom","top","bottom"],le=["leftRight","left","right"],fe=function(t){var e=t.data,n=t.curve,i=void 0===n?Tt:n,r=t.canvasContext,o=t.className,a=t.classID,s=function(){var t=Et,e=Pt,n=yt(!0),i=null,r=Tt,o=null;function a(a){var s,c,u,l=a.length,f=!1;for(null==i&&(o=r(u=_t())),s=0;s<=l;++s)!(s<l&&n(c=a[s],s,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(c,s,a),+e(c,s,a));if(u)return o=null,u+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:yt(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:yt(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:yt(!!t),a):n},a.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),a):r},a.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),a):i},a}().curve(i),c={type:"path",className:o,classID:a,data:e};return r?(s.context(r),c.pathMethods=s):c.attrs={d:s(e)},c},he=function(t){var e=t.data,n=t.canvasContext,i={type:"path",className:t.className,classID:t.classID,data:e},r=function(){var t=bt,e=wt,n=yt(0),i=null,r=jt,o=Mt,a=kt,s=null;function c(){var c,u,l=+t.apply(this,arguments),f=+e.apply(this,arguments),h=r.apply(this,arguments)-mt,d=o.apply(this,arguments)-mt,p=Math.abs(d-h),_=d>h;if(s||(s=c=_t()),f<l&&(u=f,f=l,l=u),f>vt)if(p>xt-vt)s.moveTo(f*Math.cos(h),f*Math.sin(h)),s.arc(0,0,f,h,d,!_),l>vt&&(s.moveTo(l*Math.cos(d),l*Math.sin(d)),s.arc(0,0,l,d,h,_));else{var y,v,g=h,m=d,x=h,b=d,w=p,j=p,M=a.apply(this,arguments)/2,k=M>vt&&(i?+i.apply(this,arguments):Math.sqrt(l*l+f*f)),A=Math.min(Math.abs(f-l)/2,+n.apply(this,arguments)),O=A,S=A;if(k>vt){var T=At(k/l*Math.sin(M)),E=At(k/f*Math.sin(M));(w-=2*T)>vt?(x+=T*=_?1:-1,b-=T):(w=0,x=b=(h+d)/2),(j-=2*E)>vt?(g+=E*=_?1:-1,m-=E):(j=0,g=m=(h+d)/2)}var P=f*Math.cos(g),N=f*Math.sin(g),C=l*Math.cos(b),L=l*Math.sin(b);if(A>vt){var R=f*Math.cos(m),B=f*Math.sin(m),I=l*Math.cos(x),Y=l*Math.sin(x);if(p<gt){var X=w>vt?function(t,e,n,i,r,o,a,s){var c=I-P,u=Y-N,l=C-R,f=L-B,h=(l*(N-B)-f*(P-R))/(f*c-l*u);return[P+h*c,N+h*u]}():[C,L],D=P-X[0],z=N-X[1],q=R-X[0],H=B-X[1],W=1/Math.sin(Math.acos((D*q+z*H)/(Math.sqrt(D*D+z*z)*Math.sqrt(q*q+H*H)))/2),F=Math.sqrt(X[0]*X[0]+X[1]*X[1]);O=Math.min(A,(l-F)/(W-1)),S=Math.min(A,(f-F)/(W+1))}}j>vt?S>vt?(y=Ot(I,Y,P,N,f,S,_),v=Ot(R,B,C,L,f,S,_),s.moveTo(y.cx+y.x01,y.cy+y.y01),S<A?s.arc(y.cx,y.cy,S,Math.atan2(y.y01,y.x01),Math.atan2(v.y01,v.x01),!_):(s.arc(y.cx,y.cy,S,Math.atan2(y.y01,y.x01),Math.atan2(y.y11,y.x11),!_),s.arc(0,0,f,Math.atan2(y.cy+y.y11,y.cx+y.x11),Math.atan2(v.cy+v.y11,v.cx+v.x11),!_),s.arc(v.cx,v.cy,S,Math.atan2(v.y11,v.x11),Math.atan2(v.y01,v.x01),!_))):(s.moveTo(P,N),s.arc(0,0,f,g,m,!_)):s.moveTo(P,N),l>vt&&w>vt?O>vt?(y=Ot(C,L,R,B,l,-O,_),v=Ot(P,N,I,Y,l,-O,_),s.lineTo(y.cx+y.x01,y.cy+y.y01),O<A?s.arc(y.cx,y.cy,O,Math.atan2(y.y01,y.x01),Math.atan2(v.y01,v.x01),!_):(s.arc(y.cx,y.cy,O,Math.atan2(y.y01,y.x01),Math.atan2(y.y11,y.x11),!_),s.arc(0,0,l,Math.atan2(y.cy+y.y11,y.cx+y.x11),Math.atan2(v.cy+v.y11,v.cx+v.x11),_),s.arc(v.cx,v.cy,O,Math.atan2(v.y11,v.x11),Math.atan2(v.y01,v.x01),!_))):s.arc(0,0,l,b,x,_):s.lineTo(C,L)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-gt/2;return[Math.cos(i)*n,Math.sin(i)*n]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:yt(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:yt(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:yt(+t),c):n},c.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:yt(+t),c):i},c.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:yt(+t),c):r},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:yt(+t),c):o},c.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:yt(+t),c):a},c.context=function(t){return arguments.length?(s=null==t?null:t,c):s},c}().innerRadius(e.innerRadius||0).outerRadius(e.outerRadius||e.radius||2).startAngle(e.startAngle||0).endAngle(e.endAngle||2*Math.PI);return n?(r.context(n),i.pathMethods=lineGen):i.attrs={d:r()},i},de=function(t){var e=t.type,n=t.subjectType,i=e.annotation,r=i.position,o=i.x-r.x,a=o+i.dx,s=i.y-r.y,c=s+i.dy,u=i.subject;if("circle"===n&&(u.outerRadius||u.radius)){var l=Math.sqrt((o-a)*(o-a)+(s-c)*(s-c)),f=Math.asin(-c/l),h=u.outerRadius||u.radius+(u.radiusPadding||0);o=Math.abs(Math.cos(f)*h)*(a<0?-1:1),s=Math.abs(Math.sin(f)*h)*(c<0?-1:1)}if("rect"===n){var d=u.width,p=u.height;(d>0&&i.dx>0||d<0&&i.dx<0)&&(o=Math.abs(d)>Math.abs(i.dx)?d/2:d),(p>0&&i.dy>0||p<0&&i.dy<0)&&(s=Math.abs(p)>Math.abs(i.dy)?p/2:p),o===d/2&&s===p/2&&(o=a,s=c)}return[[o,s],[a,c]]},pe=function(t){var e=t.type,n=t.connectorData,i=t.subjectType;n||(n={}),n.points&&"number"!=typeof n.points||(n.points=_e(e.annotation.offset,n.points)),n.curve||(n.curve=Ht);var r=[];if(e.editMode){var o=n.points.map(function(t,e){return ee({},function(t){var e=t.cx,n=t.cy;return{move:{x:void 0===e?0:e,y:void 0===n?0:n}}}({cx:t[0],cy:t[1]}),{index:e})});r=e.mapHandles(o.map(function(t){return ee({},t.move,{drag:function(t){n.points[t][0]+=p.dx,n.points[t][1]+=p.dy,e.redrawConnector()}.bind(e,t.index)})}))}var a=de({type:e,subjectType:i});return a=[a[0]].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n.points),[a[1]]),{components:[fe({data:a,curve:n.curve,className:"connector"})],handles:r}},_e=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t.x/(e+1),i=t.y/(e+1),r=[],o=1;o<=e;o++)r.push([n*o+o%2*20,i*o-o%2*20]);return r},ye=function(){function t(e){var n=e.a,i=e.annotation,r=e.editMode,o=e.dispatcher,a=e.notePadding,s=e.accessors;if(Kt(this,t),this.a=n,this.note=-1===i.disable.indexOf("note")&&n.select("g.annotation-note"),this.noteContent=this.note&&n.select("g.annotation-note-content"),this.connector=-1===i.disable.indexOf("connector")&&n.select("g.annotation-connector"),this.subject=-1===i.disable.indexOf("subject")&&n.select("g.annotation-subject"),this.dispatcher=o,o){var c=Te.bind(null,o,i);c({component:this.note,name:"note"}),c({component:this.connector,name:"connector"}),c({component:this.subject,name:"subject"})}this.annotation=i,this.editMode=i.editMode||r,this.notePadding=void 0!==a?a:3,this.offsetCornerX=0,this.offsetCornerY=0,s&&i.data&&this.init(s)}return te(t,[{key:"init",value:function(t){this.annotation.x||this.mapX(t),this.annotation.y||this.mapY(t)}},{key:"mapY",value:function(t){t.y&&(this.annotation.y=t.y(this.annotation.data))}},{key:"mapX",value:function(t){t.x&&(this.annotation.x=t.x(this.annotation.data))}},{key:"updateEditMode",value:function(){this.a.selectAll("circle.handle").remove()}},{key:"drawOnSVG",value:function(t,e){var n=this;Array.isArray(e)||(e=[e]),e.filter(function(t){return t}).forEach(function(e){var i=e.type,r=e.className,o=e.attrs,a=e.handles,s=e.classID;if("handle"===i)!function(t){var e=t.group,n=t.handles,i=t.r,r=void 0===i?10:i,o=e.selectAll("circle.handle").data(n);o.enter().append("circle").attr("class","handle").attr("fill","grey").attr("fill-opacity",.1).attr("cursor","move").attr("stroke-dasharray",5).attr("stroke","grey").call(ut().container($("g.annotations").node()).on("start",function(t){return t.start&&t.start(t)}).on("drag",function(t){return t.drag&&t.drag(t)}).on("end",function(t){return t.end&&t.end(t)})),e.selectAll("circle.handle").attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).attr("r",function(t){return t.r||r}).attr("class",function(t){return"handle "+(t.className||"")}),o.exit().remove()}({group:t,r:o&&o.r,handles:a});else{Se(t,[n.annotation],i,r,s);for(var c=t.select(i+"."+(s||r)),u=Object.keys(o),l=[],f=c.node().attributes,h=f.length-1;h>=0;h--){var d=f[h].name;-1===u.indexOf(d)&&"class"!==d&&l.push(d)}u.forEach(function(t){"text"===t?c.text(o[t]):c.attr(t,o[t])}),l.forEach(function(t){return c.attr(t,null)})}})}},{key:"getNoteBBox",value:function(){return Pe(this.note,".annotation-note-content text")}},{key:"getNoteBBoxOffset",value:function(){var t=Pe(this.note,".annotation-note-content"),e=this.noteContent.attr("transform").split(/\(|\,|\)/g);return t.offsetCornerX=parseFloat(e[1])+this.annotation.dx,t.offsetCornerY=parseFloat(e[2])+this.annotation.dy,t.offsetX=this.annotation.dx,t.offsetY=this.annotation.dy,t}},{key:"drawSubject",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.annotation.subject,i=e.type,r={type:this,subjectData:n},o={};"circle"===i?o=function(t){var e=t.subjectData,n=t.type;e.radius||e.outerRadius||(e.radius=20);var i=[],r=he({data:e,className:"subject"});if(n.editMode){var o=function(t){var e=t.cx,n=void 0===e?0:e,i=t.cy,r=void 0===i?0:i,o=t.r1,a=t.r2,s=t.padding,c={move:{x:n,y:r}};return void 0!==o&&(c.r1={x:n+o/Math.sqrt(2),y:r+o/Math.sqrt(2)}),void 0!==a&&(c.r2={x:n+a/Math.sqrt(2),y:r+a/Math.sqrt(2)}),void 0!==s&&(c.padding={x:n+o+s,y:r}),c}({r1:r.data.outerRadius||r.data.radius,r2:r.data.innerRadius,padding:e.radiusPadding}),a=function(t){var i=e[t]+p.dx*Math.sqrt(2);e[t]=i,n.redrawSubject(),n.redrawConnector()},s=[ee({},o.r1,{drag:a.bind(n,void 0!==e.outerRadius?"outerRadius":"radius")})];e.innerRadius&&s.push(ee({},o.r2,{drag:a.bind(n,"innerRadius")})),i=n.mapHandles(s)}return r.attrs["fill-opacity"]=0,{components:[r],handles:i}}(r):"rect"===i?o=function(t){var e=t.subjectData,n=t.type;e.width||(e.width=100),e.height||(e.height=100);var i=[],r=e.width,o=e.height,a=fe({data:[[0,0],[r,0],[r,o],[0,o],[0,0]],className:"subject"});if(n.editMode){var s=[{x:r,y:o/2,drag:function(){e.width=p.x,n.redrawSubject(),n.redrawConnector()}.bind(n)},{x:r/2,y:o,drag:function(){e.height=p.y,n.redrawSubject(),n.redrawConnector()}.bind(n)}];i=n.mapHandles(s)}return a.attrs["fill-opacity"]=.1,{components:[a],handles:i}}(r):"threshold"===i?o=function(t){var e=t.subjectData,n=t.type.annotation.position,i=(void 0!==e.x1?e.x1:n.x)-n.x,r=(void 0!==e.x2?e.x2:n.x)-n.x,o=(void 0!==e.y1?e.y1:n.y)-n.y,a=(void 0!==e.y2?e.y2:n.y)-n.y;return{components:[fe({data:[[i,o],[r,a]],className:"subject"})]}}(r):"badge"===i&&(o=function(t){var e=t.subjectData,n=void 0===e?{}:e,i=t.type,r=void 0===i?{}:i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.typeSettings&&r.typeSettings.subject;n.radius||(a&&a.radius?n.radius=a.radius:n.radius=14),n.x||a&&a.x&&(n.x=a.x),n.y||a&&a.y&&(n.y=a.y);var s=[],c=[],u=n.radius,l=.7*u,f=0,h=0,d=Math.sqrt(2)*u,_={xleftcorner:-u,xrightcorner:u,ytopcorner:-u,ybottomcorner:u,xleft:-d,xright:d,ytop:-d,ybottom:d};n.x&&!n.y?f=_["x"+n.x]:n.y&&!n.x?h=_["y"+n.y]:n.x&&n.y&&(f=_["x"+n.x+"corner"],h=_["y"+n.y+"corner"]);var y="translate("+f+", "+h+")",v=he({className:"subject",data:{radius:u}});v.attrs.transform=y,v.attrs.fill=o.color,v.attrs["stroke-linecap"]="round",v.attrs["stroke-width"]="3px";var g=he({className:"subject-ring",data:{outerRadius:u,innerRadius:l}});g.attrs.transform=y,g.attrs["stroke-width"]="3px",g.attrs.fill="white";var m=void 0;if(f&&h||!f&&!h)m=fe({className:"subject-pointer",data:[[0,0],[f||0,0],[0,h||0],[0,0]]});else if(f||h){var x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t&&t/Math.sqrt(2)/Math.sqrt(2)||e*u/Math.sqrt(2)};m=fe({className:"subject-pointer",data:[[0,0],[x(f),x(h)],[x(f,-1),x(h,-1)],[0,0]]})}if(m&&(m.attrs.fill=o.color,m.attrs["stroke-linecap"]="round",m.attrs["stroke-width"]="3px",c.push(m)),r.editMode){var b={x:2*f,y:2*h,drag:function(){n.x=p.x<2*-u?"left":p.x>2*u?"right":void 0,n.y=p.y<2*-u?"top":p.y>2*u?"bottom":void 0,r.redrawSubject()}.bind(r)};b.x||b.y||(b.y=-u),s=r.mapHandles([b])}var w=void 0;return n.text&&(w={type:"text",className:"badge-text",attrs:{fill:"white",stroke:"none","font-size":".7em",text:n.text,"text-anchor":"middle",dy:".25em",x:f,y:h}}),c.push(v),c.push(g),c.push(w),{components:c,handles:s}}(r,this.annotation));var a=o,s=a.components,c=void 0===s?[]:s,u=a.handles,l=void 0===u?[]:u;return c.forEach(function(e){e&&e.attrs&&!e.attrs.stroke&&(e.attrs.stroke=t.annotation.color)}),this.editMode&&(l=l.concat(this.mapHandles([{drag:this.dragSubject.bind(this)}])),c.push({type:"handle",handles:l})),c}},{key:"drawConnector",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.annotation.connector,i=n.type||e.type,r={type:this,connectorData:n};r.subjectType=this.typeSettings&&this.typeSettings.subject&&this.typeSettings.subject.type;var o="curve"===i?pe(r):"elbow"===i?function(t){var e=t.type,n=t.subjectType,i=e.annotation,r=i.position,o=i.x-r.x,a=o+i.dx,s=i.y-r.y,c=s+i.dy,u=i.subject;if("rect"===n){var l=u.width,f=u.height;(l>0&&i.dx>0||l<0&&i.dx<0)&&(o=Math.abs(l)>Math.abs(i.dx)?l/2:l),(f>0&&i.dy>0||f<0&&i.dy<0)&&(s=Math.abs(f)>Math.abs(i.dy)?f/2:f),o===l/2&&s===f/2&&(o=a,s=c)}var h=[[o,s],[a,c]],d=c-s,p=a-o,_=a,y=c,v=c<s&&a>o||a<o&&c>s?-1:1;if(Math.abs(p)<Math.abs(d)?(_=a,y=s+p*v):(y=c,_=o+d*v),"circle"===n&&(u.outerRadius||u.radius)){var g=(u.outerRadius||u.radius)+(u.radiusPadding||0),m=g/Math.sqrt(2);if(Math.abs(p)>m&&Math.abs(d)>m)h=[[o=m*(a<0?-1:1),s=m*(c<0?-1:1)],[_,y],[a,c]];else if(Math.abs(p)>Math.abs(d)){var x=Math.asin(-c/g);h=[[o=Math.abs(Math.cos(x)*g)*(a<0?-1:1),c],[a,c]]}else{var b=Math.acos(a/g);h=[[a,s=Math.abs(Math.sin(b)*g)*(c<0?-1:1)],[a,c]]}}else h=[[o,s],[_,y],[a,c]];return{components:[fe({data:h,className:"connector"})]}}(r):function(t){var e=de(r);return{components:[fe({data:e,className:"connector"})]}}(),a=o.components,s=void 0===a?[]:a,c=o.handles,u=void 0===c?[]:c,l=s[0];l&&(l.attrs.stroke=this.annotation.color,l.attrs.fill="none");var f=n.end||e.end,h={};if("arrow"===f){var d=l.data[1],p=l.data[0];Math.sqrt(Math.pow(d[0]-p[0],2)+Math.pow(d[1]-p[1],2))<5&&l.data[2]&&(d=l.data[2]),h=function(t){var e=t.annotation,n=t.start,i=t.end,r=t.scale,o=void 0===r?1:r,a=e.position;n=n?[-i[0]+n[0],-i[1]+n[1]]:[e.dx,e.dy],i||(i=[e.x-a.x,e.y-a.y]);var s=i[0],c=i[1],u=n[0],l=n[1],f=10*o,h=16/180*Math.PI,d=Math.atan(l/u);u<0&&(d+=Math.PI);var p=[[s,c],[Math.cos(d+h)*f+s,Math.sin(d+h)*f+c],[Math.cos(d-h)*f+s,Math.sin(d-h)*f+c],[s,c]];return{components:[fe({data:p,className:"connector-end connector-arrow",classID:"connector-end"})]}}({annotation:this.annotation,start:d,end:p,scale:n.endScale})}else"dot"===f?h=function(t){var e=t.line,n=t.scale,i=void 0===n?1:n,r=he({className:"connector-end connector-dot",classID:"connector-end",data:{radius:3*Math.sqrt(i)}});return r.attrs.transform="translate("+e.data[0][0]+", "+e.data[0][1]+")",{components:[r]}}({line:l,scale:n.endScale}):f&&"none"!==f||this.connector&&this.connector.select(".connector-end").remove();return h.components&&(h.components.forEach(function(e){e.attrs.fill=t.annotation.color,e.attrs.stroke=t.annotation.color}),s=s.concat(h.components)),this.editMode&&0!==u.length&&s.push({type:"handle",handles:u}),s}},{key:"drawNote",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.annotation.note,i=n.align||e.align||"dynamic",r={bbox:e.bbox,align:i,offset:this.annotation.offset},o=n.lineType||e.lineType,a={};"vertical"===o?a=function(t){var e=t.align,n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r,a=t.bbox;"top"===(e=se(e,t.offset.y))?o-=a.height:"middle"===e&&(o-=a.height/2);var s=[[i,o],[i,o+a.height]];return{components:[fe({data:s,className:"note-line"})]}}(r):"horizontal"===o&&(a=function(t){var e=t.align,n=t.x,i=void 0===n?0:n,r=t.y,o=void 0===r?0:r,a=t.bbox;"right"===(e=ce(e,t.offset.x))?i-=a.width:"middle"===e&&(i-=a.width/2);var s=[[i,o],[i+a.width,o]];return{components:[fe({data:s,className:"note-line"})]}}(r));var s=a,c=s.components,u=void 0===c?[]:c,l=s.handles,f=void 0===l?[]:l;if(u.forEach(function(e){e.attrs.stroke=t.annotation.color}),this.editMode){f=this.mapHandles([{x:0,y:0,drag:this.dragNote.bind(this)}]),u.push({type:"handle",handles:f});var h=this.dragNote.bind(this),d=this.dragstarted.bind(this),p=this.dragended.bind(this);this.note.call(ut().container($("g.annotations").node()).on("start",function(t){return d(t)}).on("drag",function(t){return h(t)}).on("end",function(t){return p(t)}))}else this.note.on("mousedown.drag",null);return u}},{key:"drawNoteContent",value:function(t){var e=this.annotation.note,n=void 0!==e.padding?e.padding:this.notePadding,i=e.orientation||t.orientation||"topBottom",r=e.lineType||t.lineType,o=e.align||t.align||"dynamic";"vertical"===r?i="leftRight":"horizontal"===r&&(i="topBottom");var a=function(t){var e=t.padding,n=void 0===e?0:e,i=t.bbox,r=void 0===i?{x:0,y:0,width:0,height:0}:i,o=t.align,a=t.orientation,s=t.offset,c=void 0===s?{x:0,y:0}:s,u=-r.x,l=0;return-1!==ue.indexOf(a)?(o=ce(o,c.x),c.y<0&&"topBottom"===a||"top"===a?l-=r.height+n:l+=n,"middle"===o?u-=r.width/2:"right"===o&&(u-=r.width)):-1!==le.indexOf(a)&&(o=se(o,c.y),c.x<0&&"leftRight"===a||"left"===a?u-=r.width+n:u+=n,"middle"===o?l-=r.height/2:"top"===o&&(l-=r.height)),{x:u,y:l}}({padding:n,bbox:t.bbox,offset:this.annotation.offset,orientation:i,align:o}),s=a.x,c=a.y;return this.offsetCornerX=s+this.annotation.dx,this.offsetCornerY=c+this.annotation.dy,this.note&&this.noteContent.attr("transform","translate("+s+", "+c+")"),[]}},{key:"drawOnScreen",value:function(t,e){return this.drawOnSVG(t,e)}},{key:"redrawSubject",value:function(){this.subject&&this.drawOnScreen(this.subject,this.drawSubject())}},{key:"redrawConnector",value:function(){this.connector&&this.drawOnScreen(this.connector,this.drawConnector())}},{key:"redrawNote",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNoteBBox();this.noteContent&&this.drawOnScreen(this.noteContent,this.drawNoteContent({bbox:t})),this.note&&this.drawOnScreen(this.note,this.drawNote({bbox:t}))}},{key:"setPosition",value:function(){var t=this.annotation.position;this.a.attr("transform","translate("+t.x+", "+t.y+")")}},{key:"setOffset",value:function(){if(this.note){var t=this.annotation.offset;this.note.attr("transform","translate("+t.x+", "+t.y+")")}}},{key:"setPositionWithAccessors",value:function(t){t&&this.annotation.data&&(this.mapX(t),this.mapY(t)),this.setPosition()}},{key:"setClassName",value:function(){this.a.attr("class","annotation "+(this.className&&this.className())+" "+(this.editMode?"editable":"")+" "+(this.annotation.className||""))}},{key:"draw",value:function(){this.setClassName(),this.setPosition(),this.setOffset(),this.redrawSubject(),this.redrawConnector(),this.redrawNote()}},{key:"dragstarted",value:function(){p.sourceEvent.stopPropagation(),this.dispatcher&&this.dispatcher.call("dragstart",this.a,this.annotation),this.a.classed("dragging",!0),this.a.selectAll("circle.handle").style("pointer-events","none")}},{key:"dragended",value:function(){this.dispatcher&&this.dispatcher.call("dragend",this.a,this.annotation),this.a.classed("dragging",!1),this.a.selectAll("circle.handle").style("pointer-events","all")}},{key:"dragSubject",value:function(){var t=this.annotation.position;t.x+=p.dx,t.y+=p.dy,this.annotation.position=t}},{key:"dragNote",value:function(){var t=this.annotation.offset;t.x+=p.dx,t.y+=p.dy,this.annotation.offset=t}},{key:"mapHandles",value:function(t){var e=this;return t.map(function(t){return ee({},t,{start:e.dragstarted.bind(e),end:e.dragended.bind(e)})})}}]),t}(),ve=function(t,e,n){return function(i){function r(t){Kt(this,r);var n=re(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t));return n.typeSettings=e,e.disable&&e.disable.forEach(function(t){n[t]&&n[t].remove(),n[t]=void 0,"note"===t&&(n.noteContent=void 0)}),n}return ie(r,t),te(r,[{key:"className",value:function(){return""+(e.className||ne(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"className",this)&&ne(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"className",this).call(this)||"")}},{key:"drawSubject",value:function(t){return this.typeSettings.subject=ee({},e.subject,this.typeSettings.subject),ne(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"drawSubject",this).call(this,ee({},t,this.typeSettings.subject))}},{key:"drawConnector",value:function(t){return this.typeSettings.connector=ee({},e.connector,this.typeSettings.connector),ne(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"drawConnector",this).call(this,ee({},t,e.connector,this.typeSettings.connector))}},{key:"drawNote",value:function(t){return this.typeSettings.note=ee({},e.note,this.typeSettings.note),ne(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"drawNote",this).call(this,ee({},t,e.note,this.typeSettings.note))}},{key:"drawNoteContent",value:function(t){return ne(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"drawNoteContent",this).call(this,ee({},t,e.note,this.typeSettings.note))}}],[{key:"init",value:function(t,e){return ne(r.__proto__||Object.getPrototypeOf(r),"init",this).call(this,t,e),n&&(t=n(t,e)),t}}]),r}()},ge=function(t){function e(t){Kt(this,e);var n=re(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.textWrap=t.textWrap||120,n.drawText(),n}return ie(e,ye),te(e,[{key:"updateTextWrap",value:function(t){this.textWrap=t,this.drawText()}},{key:"drawText",value:function(){if(this.note){Se(this.note,[this.annotation],"g","annotation-note-content");var t=this.note.select("g.annotation-note-content");Se(t,[this.annotation],"rect","annotation-note-bg"),Se(t,[this.annotation],"text","annotation-note-label"),Se(t,[this.annotation],"text","annotation-note-title");var e={height:0},n=this.a.select("text.annotation-note-label"),i=this.annotation.note&&this.annotation.note.wrap||this.typeSettings&&this.typeSettings.note&&this.typeSettings.note.wrap||this.textWrap,r=this.annotation.note&&this.annotation.note.wrapSplitter||this.typeSettings&&this.typeSettings.note&&this.typeSettings.note.wrapSplitter,o=this.annotation.note&&this.annotation.note.bgPadding||this.typeSettings&&this.typeSettings.note&&this.typeSettings.note.bgPadding,a={top:0,bottom:0,left:0,right:0};if("number"==typeof o?a={top:o,bottom:o,left:o,right:o}:o&&"object"===(void 0===o?"undefined":Qt(o))&&(a=ee(a,o)),this.annotation.note.title){var s=this.a.select("text.annotation-note-title");s.text(this.annotation.note.title),s.attr("fill",this.annotation.color),s.attr("font-weight","bold"),s.call(Ee,i,r),e=s.node().getBBox()}n.text(this.annotation.note.label).attr("dx","0"),n.call(Ee,i,r),n.attr("y",1.1*e.height||0),n.attr("fill",this.annotation.color);var c=this.getNoteBBox();this.a.select("rect.annotation-note-bg").attr("width",c.width+a.left+a.right).attr("height",c.height+a.top+a.bottom).attr("x",c.x-a.left).attr("y",-a.top).attr("fill","white").attr("fill-opacity",0)}}}]),e}(),me=ve(ge,{className:"label",note:{align:"middle"},disable:["subject"]}),xe=ve(ge,{className:"callout",note:{lineType:"horizontal"},disable:["subject"]}),be=ve(xe,{className:"callout elbow",connector:{type:"elbow"},disable:["subject"]}),we=ve(xe,{className:"callout curve",connector:{type:"curve"},disable:["subject"]}),je=ve(ye,{className:"badge",subject:{type:"badge"},disable:["connector","note"]}),Me=ve(ge,{className:"callout circle",subject:{type:"circle"},note:{lineType:"horizontal"},connector:{type:"elbow"}}),ke=ve(ge,{className:"callout rect",subject:{type:"rect"},note:{lineType:"horizontal"},connector:{type:"elbow"}}),Ae=function(t){function e(){return Kt(this,e),re(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return ie(e,xe),te(e,[{key:"mapY",value:function(t){ne(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mapY",this).call(this,t);var n=this.annotation;(n.subject.x1||n.subject.x2)&&n.data&&t.y&&(n.y=t.y(n.data)),!n.subject.x1&&!n.subject.x2||n.x||(n.x=n.subject.x1||n.subject.x2)}},{key:"mapX",value:function(t){ne(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mapX",this).call(this,t);var n=this.annotation;(n.subject.y1||n.subject.y2)&&n.data&&t.x&&(n.x=t.x(n.data)),!n.subject.y1&&!n.subject.y2||n.y||(n.y=n.subject.y1||n.subject.y2)}}]),e}(),Oe=ve(Ae,{className:"callout xythreshold",subject:{type:"threshold"}}),Se=function(t,e,n,i,r){var o=t.selectAll(n+"."+(r||i)).data(e);return o.enter().append(n).merge(o).attr("class",i),o.exit().remove(),t},Te=function(t,e,n){var i=n.component,r=n.name;i&&i.on("mouseover.annotations",function(){t.call(r+"over",i,e)}).on("mouseout.annotations",function(){return t.call(r+"out",i,e)}).on("click.annotations",function(){return t.call(r+"click",i,e)})},Ee=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.2;t.each(function(){for(var t=$(this),r=t.text().split(n||/[ \t\r\n]+/).reverse().filter(function(t){return""!==t}),o=void 0,a=[],s=t.text(null).append("tspan").attr("x",0).attr("dy","0.8em");o=r.pop();)a.push(o),s.text(a.join(" ")),s.node().getComputedTextLength()>e&&a.length>1&&(a.pop(),s.text(a.join(" ")),a=[o],s=t.append("tspan").attr("x",0).attr("dy",i+"em").text(o))})},Pe=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:":not(.handle)";return t?t.selectAll(e).nodes().reduce(function(t,e){var n=e.getBBox();t.x=Math.min(t.x,n.x),t.y=Math.min(t.y,n.y),t.width=Math.max(t.width,n.width);var i=e&&e.attributes&&e.attributes.y;return t.height=Math.max(t.height,(i&&parseFloat(i.value)||0)+n.height),t},{x:0,y:0,width:0,height:0}):{x:0,y:0,width:0,height:0}};function Ne(){var t=[],e=void 0,n=void 0,i=[],r={},o={},a=!1,s=void 0,c=xe,u=void 0,l=void 0,f=tt("subjectover","subjectout","subjectclick","connectorover","connectorout","connectorclick","noteover","noteout","noteclick","dragend","dragstart"),h=void 0,d=function(n){h=n,a||n.selectAll("circle.handle").remove();var d=t.map(function(t){return t.type||(t.type=c),t.disable||(t.disable=i),new oe(t)});e=e||new ae({annotations:d,accessors:r,accessorsInverse:o,ids:s}),n.selectAll("g").data([e]).enter().append("g").attr("class","annotations");var p=n.select("g.annotations");Se(p,e.annotations,"g","annotation"),p.selectAll("g.annotation").each(function(t){var e=$(this);e.attr("class","annotation"),Se(e,[t],"g","annotation-connector"),Se(e,[t],"g","annotation-subject"),Se(e,[t],"g","annotation-note"),Se(e.select("g.annotation-note"),[t],"g","annotation-note-content"),t.type="[object Object]"===t.type.toString()?t.type:new t.type({a:e,annotation:t,textWrap:u,notePadding:l,editMode:a,dispatcher:f,accessors:r}),t.type.draw(),t.type.drawText&&t.type.drawText()})};return d.json=function(){return console.log("Annotations JSON was copied to your clipboard. Please note the annotation type is not JSON compatible. It appears in the objects array in the console, but not in the copied JSON.",e.json),window.copy(JSON.stringify(e.json.map(function(t){return delete t.type,t}))),d},d.update=function(){return t&&e&&(t=e.annotations.map(function(t){return t.type.draw(),t})),d},d.updateText=function(){return e&&(e.updateText(u),t=e.annotations),d},d.updatedAccessors=function(){return e.setPositionWithAccessors(),t=e.annotations,d},d.disable=function(n){return arguments.length?(i=n,e&&(e.updateDisable(i),t=e.annotations),d):i},d.textWrap=function(n){return arguments.length?(u=n,e&&(e.updateTextWrap(u),t=e.annotations),d):u},d.notePadding=function(n){return arguments.length?(l=n,e&&(e.updateNotePadding(l),t=e.annotations),d):l},d.type=function(n,i){return arguments.length?(c=n,e&&(e.annotations.map(function(t){t.type.note&&t.type.note.selectAll("*:not(.annotation-note-content)").remove(),t.type.noteContent&&t.type.noteContent.selectAll("*").remove(),t.type.subject&&t.type.subject.selectAll("*").remove(),t.type.connector&&t.type.connector.selectAll("*").remove(),t.type.typeSettings={},t.type=c,t.subject=i&&i.subject||t.subject,t.connector=i&&i.connector||t.connector,t.note=i&&i.note||t.note}),t=e.annotations),d):c},d.annotations=function(n){return arguments.length?(t=n,e&&e.annotations&&(t.some(function(t){return!t.type||"[object Object]"!==t.type.toString()})?(e=null,d(h)):e.annotations=t),d):e&&e.annotations||t},d.context=function(t){return arguments.length?(n=t,d):n},d.accessors=function(t){return arguments.length?(r=t,d):r},d.accessorsInverse=function(t){return arguments.length?(o=t,d):o},d.ids=function(t){return arguments.length?(s=t,d):s},d.editMode=function(n){return arguments.length?(a=n,h&&h.selectAll("g.annotation").classed("editable",a),e&&(e.editMode(a),t=e.annotations),d):a},d.collection=function(t){return arguments.length?(e=t,d):e},d.on=function(){var t=f.on.apply(f,arguments);return t===f?d:t},d}var Ce={annotation:Ne,annotationTypeBase:ye,annotationLabel:me,annotationCallout:xe,annotationCalloutCurve:we,annotationCalloutElbow:be,annotationCalloutCircle:Me,annotationCalloutRect:ke,annotationXYThreshold:Oe,annotationBadge:je,annotationCustomType:ve};e.default=Ce},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=function(t){return t&&t.__esModule?t:{default:t}}(n(0)),s={top:160,bottom:10,left:0,right:12},c=12,u=16,l=.4,f=91,h=640,d=5*c,p=8*u,_=0,y=0,v=null,g=null,m=null,x=null,b=d3.select("#impact").select("figure"),w=b.select(".figure__chart"),j=w.select("svg"),M=j.select(".g-vis"),k=j.select(".g-axis"),A=j.select(".g-annotations"),O=b.select(".annotation-toggle input"),S=null;function T(){var t=this.checked;A.classed("is-visible",t)}function E(t){var e=d3.select(this).parent(),n=d3.mouse(this),i=r(n,1)[0],o=Math.floor(m.invert(i));if(o>=30){var a=t.pageviews.find(function(t){return t.bin_death_index===o}),s=function(t){return d3.format(".0%")(t)}(a.diff_percent),c=x(a.diff_percent);e.selectAll(".tip").text(""+s).at("transform","translate("+i+", "+c+")")}}function P(t){var e=t.pageid;S.classed("is-active",function(t){return t.pageid===e}),S.classed("is-inactive",function(t){return t.pageid!==e})}function N(){d3.select(this).parent().selectAll(".tip").text("")}function C(){S.classed("is-active",!1),S.classed("is-inactive",!1)}function L(){_=w.node().offsetWidth-s.left-s.right,y=d*l*v.length+d}function R(){L();var t=d3.select("body").node().offsetWidth<h;p=t?5*u:8*u,d=t?6.5*c:5*c,t&&(s.top=190),j.at({width:_+s.left+s.right,height:y+s.top+s.bottom}),M.at("transform","translate("+s.left+", "+s.top+")"),A.at("transform","translate("+s.left+", "+s.top+")");var e=d3.extent(g,function(t){return t.bin_death_index});m=d3.scaleLinear().domain(e).range([p+c,_]),x=d3.scaleLinear().domain([0,20]).range([d,0]);var n=d3.line().x(function(t){return m(t.bin_death_index)}).y(function(t){return x(t.diff_percent)}).curve(d3.curveMonotoneX).defined(function(t){return t.ma}),i=d3.area().x(function(t){return m(t.bin_death_index)}).y0(x(0)).y1(function(t){return x(t.diff_percent)}).curve(d3.curveMonotoneX).defined(function(t){return t.ma}),r=S.select(".name");r.at({x:p,y:x.range()[0],transform:"translate(0, 0)"}).selectAll("tspan").remove(),t?(r.tspans(function(t){return d3.wordwrap(t.display,11)}),r.each(function(t,e,n){var i=d3.select(n[e]),r=i.selectAll("tspan"),o=r.size();r.filter(function(t,e){return 0!==e}).at("dy","1.2em");var a=o>1?-10:-5;i.at("transform","translate(0, "+a+")")})):S.select(".name").text(function(t){return t.display}).at("text-anchor","end"),S.select(".after--area").datum(function(t){return t.pageviews}).at("d",i),S.select(".after--line").datum(function(t){return t.pageviews}).at("d",n),S.at("transform",function(t,e){return"translate(0,"+e*d*l+")"});var a=d*l,f=d*(1-l);S.select(".interaction").at({width:_,height:a,y:f});var b=d3.axisTop(m).tickValues([30,60,90,120,150]).tickSize(-y).tickFormat(function(t,e){return t+(0===e?" days after death":"")});k.select(".axis").call(b).at("transform","translate("+s.left+", "+(s.top-d*l)+")"),t?k.selectAll(".tick").select("text").at("text-anchor","middle"):k.select(".tick").select("text").at("text-anchor","start"),function(t){A.select(".g-annotation").remove();var e=A.append("g.g-annotation"),n={float:o.annotationCustomType(o.annotationLabel,{className:"float",note:{dy:2,align:"middle",orientation:"leftRight"}}),line:o.annotationCustomType(o.annotationLabel,{className:"line",connector:{type:"line"},note:{dy:2,align:"dynamic",orientation:"leftRight"}})},i=.75*c,r=t.map(function(t){return{type:n[t.impact_type],note:{dy:2,title:t.title,bgPadding:{top:i,left:i,right:i,bottom:i/2},padding:0,wrap:230},data:{s:"Lil Peep"===t.name?-120:0,impact_index:t.impact_index,bin_death_index:t.bin_death_index,diff_percent:t.diff_percent},dx:t.dx,dy:t.dy}}),a=o.annotation().accessors({x:function(t){return m(t.bin_death_index)+t.s},y:function(t){return t.impact_index*d*l+x(t.diff_percent)}}).annotations(r);e.call(a),e.selectAll(".annotation-note-title").selectAll("tspan").filter(function(t,e){return 0!==e}).at("dy","1.4em")}(v.filter(function(t){return t.impact_annotation}).map(function(t){return{name:t.name,impact_index:t.impact_index,impact_type:t.impact_type,bin_death_index:+t.impact_x,diff_percent:function(t){var e=+t.impact_x;return t.pageviews.find(function(t){return t.bin_death_index===e}).diff_percent}(t),dx:function(t){return+t.impact_x>75?t.impact_dx?+t.impact_dx:-30:t.impact_dx?+t.impact_dx:30}(t),dy:t.impact_dy?+t.impact_dy:-15,title:t.impact_annotation,padding:0}}))}e.default={init:function(t){(function(t){return new Promise(function(e,n){var r,o=["impact"].map(function(t){return"assets/data/"+t+".csv"});(r=d3).loadData.apply(r,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(o).concat([function(r,o){r&&n(r),g=a.default.ma(o[0]),v=t.map(function(t){var e=g.filter(function(e){return e.pageid===t.pageid});return i({},t,{pageviews:e})}).filter(function(t){return t.pageviews.length===f}),e()}]))})})(t).then(function(){L(),function(){v.sort(function(t,e){var n=d3.median(t.pageviews,function(t){return t.diff_percent}),i=d3.median(e.pageviews,function(t){return t.diff_percent});return d3.descending(n,i)}),v.forEach(function(t,e){return t.impact_index=e}),j.on("mouseleave",C);var t=(S=M.selectAll(".person")).data(v).enter().append("g.person");(S=t.merge(S)).append("text.name"),S.append("path.after--area"),S.append("path.after--line"),S.append("text.tip.tip--bg").at({x:0,y:-c/2,"text-anchor":"middle"}),S.append("text.tip.tip--fg").at({x:0,y:-c/2,"text-anchor":"middle"}),S.append("rect.interaction").at({x:0,y:0}).on("mouseenter",P).on("mousemove",E).on("mouseleave",N)}(),O.on("change",T),R()})},resize:R,filter:function(t){var e=t.name,n=t.value;e?(j.classed("is-faded",!0),S.classed("is-faded",function(t){return!t[e].includes(n)})):(j.classed("is-faded",!1),S.classed("is-faded",!1))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=(a(n(0)),a(n(13)));function a(t){return t&&t.__esModule?t:{default:t}}var s=null,c=d3.select("#change"),u=c.select("figure"),l=u.select("table").select("tbody"),f=c.select(".btn");function h(t){return d3.format(",")(Math.round(t))}e.default={init:function(t){(function(t){return new Promise(function(e,n){s=t.map(function(t){return i({},t,{change:t.death_views_adjusted_2/t.median_views_adjusted_bd_2})}),e()})})(t).then(function(){(function(){s.sort(function(t,e){return d3.descending(t.change,e.change)});var t=d3.extent(s,function(t){return t.change}),e=d3.scaleLinear().domain(t).range([0,.8]),n=l.selectAll("tr").data(s).enter().append("tr"),i=n.append("td.name");i.append("a").text(function(t){return t.display}).at("href",function(t){return t.link}).at("target","_blank"),i.append("span").text(function(t){return t.description_short}),n.append("td.avg.number").text(function(t){return h(t.median_views_adjusted_bd_2)}),n.append("td.death.number").text(function(t){return h(t.death_views_adjusted_2)}),n.append("td.change.number").text(function(t,e){return function(t){return d3.format(",.0%")(t)}(t.change).replace("%","")}).st("background-color",function(t){var n=r(o.default.primary.rgb,3);return"rgba("+n[0]+","+n[1]+", "+n[2]+", "+e(t.change)+")"})})(),f.on("click",function(){var t=u.classed("is-truncated"),e=t?"Show Fewer":"Show More";if(f.text(e),u.classed("is-truncated",!t),!t){var n=+f.at("data-y");window.scrollTo(0,n)}f.at("data-y",window.scrollY),u.select(".show-more").classed("is-visible",!t)})})},resize:function(){},filter:function(t){var e=t.name,n=t.value,i=l.selectAll("tr");e?i.classed("is-faded",function(t){return!t[e].includes(n)}):i.classed("is-faded",!1)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=s(n(0)),a=s(n(5));function s(t){return t&&t.__esModule?t:{default:t}}d3.easeCubicInOut;var c=12,u=null,l=null,f=d3.select("#care").select(".figure--chart").select("ul"),h=null;function d(t){var e=d3.mouse(this),n=d3.mouse(f.node()),i=r(n,2),o=i[0],s=i[1],c={x:o-e[0],y:s};a.default.show({el:h,d:t,pos:c})}function p(){window.innerHeight}e.default={init:function(t){(function(t){return new Promise(function(e,n){var r,a=["care"].map(function(t){return"assets/data/"+t+".csv"});(r=d3).loadData.apply(r,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(a).concat([function(r,a){r&&n(r),l=o.default.pageview(a[0]),u=t.map(function(t){return i({},t,{pageviews:l.filter(function(e){return e.pageid===t.pageid})})}).map(function(t){var e=t.pageviews.length,n=function(t){var e=t.last_updated,n=t.pageviews,i=n.length;return n[i-1].timestamp===e?null:Math.floor(i/7)}(t);return i({},t,{days_until_norm:e,weeks_until_norm:n,week_category:n||0===n?n<=c?n:c+1:c+2})}),e()}]))})})(t).then(function(){p(),function(){var t=d3.nest().key(function(t){return t.week_category}).entries(u).map(function(t){return i({},t,{key:+t.key})}),e=d3.range(c+3).map(function(e){return t.find(function(t){return t.key===e})||{key:e,values:[]}}),n=f.selectAll(".week").data(e).enter().append("li.week");n.append("p.label").html(function(t){if(t.key===c+1)return t.key+"+";if(t.key===c+2)return"TBD";var e=1===t.key?"":"s",n=0===t.key?" until normal traffic":"";return t.key+"&nbsp;<span>week"+e+n+"</span>"}),n.append("ul.people").selectAll(".person").data(function(t){return t.values}).enter().append("li.person").on("mouseenter",d).on("mouseleave",function(){a.default.hide(h)}).append("a").text(function(t){return t.display}).at("href",function(t){return t.link}).at("target","_blank")}(),h=a.default.init({container:f}),f.on("mouseleave",function(){a.default.hide(h)})})},resize:p,filter:function(t){var e=t.name,n=t.value,i=f.selectAll(".person");e?i.classed("is-faded",function(t){return!t[e].includes(n)}):i.classed("is-faded",!1)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=d3.select("header").node().offsetHeight;function r(t){t[0].classed("is-visible",!1)}e.default={init:function(t){var e=t.container,n=e.append("div.tooltip"),i=e.append("div.tooltip.tooltip--hidden"),o=[n,i];return o.forEach(function(t){var e=t.append("div.info"),n=e.append("p.display");n.append("span.name"),n.append("span.date-of-death");var i=e.append("p.bio");i.append("div.thumbnail"),i.append("span"),e.append("p.cause").html("Cause of death: <span></span>");var a=t.append("div.close").append("button");a.text("Close"),a.on("click",function(){return r(o)})}),[n,i]},show:function(t){var e=t.el,n=t.d,r=t.pos,o=t.mobile;e.forEach(function(t){t.select(".name").text(n.display),t.select(".date-of-death").text(n.date_of_death+", "+n.year_of_death),t.select(".bio span").text(n.extract_truncated),t.select(".cause span").text(n.cause_specific),t.select(".thumbnail").st("background-image","url("+n.thumbnail_source+")")});var a=r.x,s=r.y;e[1].st({top:s,left:a});var c=function(t){var e=t.el,n=t.pos;e[1].st({top:n.y,left:n.x});var r=e[1].node().getBoundingClientRect(),o=r.top,a=r.left,s=r.right,c={center:!0,left:!1,right:!1,bottom:!1};return o-i<0&&(c.bottom=!0),s>window.innerWidth-32&&(c.center=!1,c.right=!0),a<32&&(c.center=!1,c.left=!0),c}({el:e,pos:r});o?e[0].classed("is-visible",!0):e[0].st({top:s,left:a}).classed("is-visible",!0).classed("is-center",c.center).classed("is-right",c.right).classed("is-left",c.left).classed("is-bottom",c.bottom)},hide:r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=(c(n(17)),c(n(16))),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(1)),a=c(n(0)),s=c(n(5));function c(t){return t&&t.__esModule?t:{default:t}}var u={top:20,bottom:40,left:50,right:50},l=12,f="57317",h=new Date(2016,2,1),d=new Date(2016,3,27),p=3e3,_=d3.easeCubicInOut,y=d3.select("header").node().offsetHeight,v=640,g=4,m=16,x=!1,b=0,w=0,j=0,M=null,k=null,A=null,O="context",S=!1,T=d3.select("#perspective"),E=T.select("article"),P=E.selectAll(".step"),N=T.select("figure"),C=N.select(".figure__chart"),L=C.select("svg"),R=L.select(".g-vis"),B=L.select(".g-axis"),I=L.select(".g-voronoi"),Y=R.select(".people"),X=N.select(".legend"),D=d3.select(".filters"),z=null,q=(0,r.default)(),H=((0,r.default)(),d3.voronoi());function W(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A[0].pageviews;return d3.scaleTime().domain(d3.extent(t,function(t){return t.date})).nice().range([0,b])}function F(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A[0].pageviews,e=d3.max(t,function(t){return t.views_adjusted});return d3.scaleLinear().domain([0,e]).nice().range([w,0])}function V(t){var e=t.scaleX,n=t.scaleY;return d3.line().x(function(t){return e(t.date)}).y(function(t){return n(t.views_adjusted)}).curve(d3.curveMonotoneX).defined(function(t){return t.views_adjusted})}function $(t){var e=t.scaleX,n=t.scaleY,i=t.dur,r=t.ticks,o=void 0===r?d3.timeMonth.every(1):r,a=t.ease,s=void 0===a?_:a,c=d3.axisLeft(n).tickFormat(function(t,e){return d3.format(".2s")(t)+(6===e?" adjusted pageviews":"")}).tickSize(-(b+u.left)).tickPadding(u.left).ticks(5);B.select(".axis--y").transition().duration(i.slow).ease(s).call(c).at("transform","translate("+u.left+", "+u.top+")"),B.selectAll(".axis--y text").at("text-anchor","start").at("y",-l/2),B.selectAll(".axis--y line").at("transform","translate("+-u.left+", 0)");var f=x&&e.domain()[1]>new Date(2017,0)?function(t){return(d3.timeYear(t)<t?x?function(){}:d3.timeFormat("%b"):d3.timeFormat("%Y"))(t)}:function(t){return d3.timeFormat("%b")(t)},h=d3.axisBottom(e).ticks(o).tickSize(0).tickPadding(0).tickFormat(f);B.select(".axis--x").transition().duration(i.slow).ease(s).call(h).at("transform","translate("+u.left+", "+(w+u.bottom-l)+")")}function U(t,e){var n=t.selectAll("path"),i=n.node().getTotalLength(),r=e?i-e:i;n.at({"stroke-dasharray":i+" "+i,"stroke-dashoffset":r})}function G(t){t.at("data-id",function(t){return t.pageid}),t.append("path"),t.append("g.circles"),t.append("text.bg").text(function(t){return t.display}).at("x",0).at("y",0).at("text-anchor","middle").at("alignment-baseline","baseline").st("opacity",0),t.append("text.fg").text(function(t){return t.display}).at("x",0).at("y",0).at("text-anchor","middle").at("alignment-baseline","baseline").st("opacity",0)}function J(t,e){t.exit().transition().duration(e).st("opacity",0).remove()}function Z(t,e){var n=e.scaleX,i=e.scaleY,r=e.r,o=void 0===r?g:r,a=t.select(".circles").selectAll("circle").data(function(t){return t.pageviews.filter(function(t){return["beyonce",f].includes(t.pageid)||0===t.bin_death_index})},function(t){return t.timestamp});a.enter().append("circle").classed("is-not-death-index",function(t){return 0!==t.bin_death_index}).at({cx:0,cy:0,r:o}).at("transform",function(t){return"translate("+n(t.date)+", "+i(t.views_adjusted)+")"}).merge(a).at("data-x",function(t){return n(t.date)}).at("data-y",function(t){return i(t.views_adjusted)}),a.exit().remove()}function Q(t,e){var n=e.scaleX,i=e.scaleY,r=e.render,o=void 0===r||r,a=V({scaleX:n,scaleY:i});t.datum().pageviews.length>1&&(t.selectAll("path").data(function(t){return[t.pageviews]}),o&&t.selectAll("path").at("d",a))}function K(t,e){var n=e.start,r=void 0===n?-1:n,o=e.end,a=void 0===o?0:o;return t.map(function(t){return i({},t)}).filter(function(t){return t.bin_death_index>=r&&t.bin_death_index<=a})}function tt(t){var e=M.find(function(t){return t.pageid===f}).pageviews;return e[e.map(function(e,n){return{i:n,date:e.date,diff:e.date-t}}).filter(function(t){return t.diff>0})[0].i].bin_death_index}function et(t){var e=t.leave,n=t.reverse,i=1;e?i=0:n&&(i=.33);var r=p*i;return{slow:r,medium:Math.floor(.33*r),fast:Math.floor(.1*r)}}function nt(t){if(S&&"compare"===O){var e=t.data.pageid,n=M.find(function(t){return t.pageid===e});Y.selectAll(".person").classed("is-active",function(t){return t.pageid===e});var i=d3.select("[data-id='"+e+"'");if(i.size()){i.raise();var r=i.selectAll("circle").filter(function(t){return 0===t.bin_death_index}),o={x:+r.at("data-x")+u.left,y:+r.at("data-y")+u.top};s.default.show({el:z,d:n,pos:o,mobile:x})}}}function it(t){var e=t.scaleX,n=t.scaleY,i=t.annoData,r=t.dur,a=void 0===r?0:r,s=t.delay,c=void 0===s?0:s;R.select(".g-annotation").remove();var u=R.append("g.g-annotation");u.st("opacity",0);var f=o.annotationCustomType(o.annotationCalloutCircle,{className:"custom",connector:{type:"line"},note:{align:"dynamic"}}),h=.75*l,d=i.map(function(t){return{note:{title:t.title,padding:t.padding,wrap:t.wrap||110,bgPadding:{top:.825*h,left:h,right:h,bottom:0}},data:{date:t.value.date,views_adjusted:t.value.views_adjusted},dx:t.dx,dy:t.dy,subject:{radius:t.r,radiusPadding:g}}}),p=o.annotation().type(f).accessors({x:function(t){return e(t.date)},y:function(t){return n(t.views_adjusted)}}).annotations(d);u.call(p),u.selectAll(".annotation-note-title").selectAll("tspan").filter(function(t,e){return 0!==e}).at("dy","1.4em"),u.transition().duration(a).delay(c).ease(_).st("opacity",1)}var rt={context:function(t){var e=t.reverse,n=et({leave:t.leave,reverse:e}),i=A,r=W(),o=F();$({scaleX:r,scaleY:o,dur:{slow:0}});var a=Y.selectAll(".person").data(i,function(t){return t.pageid}),s=a.enter().append("g.person").call(G).merge(a);s.call(Q,{scaleX:r,scaleY:o}),s.call(Z,{scaleX:r,scaleY:o}),s.classed("is-highlight",!0),s.selectAll("circle").transition().duration(n.fast).ease(_).at("r",g).st("stroke-width",g/2),it({scaleX:r,scaleY:o,annoData:[]}),J(a,n.fast)},lemonade:function(t){var e=t.reverse,n=t.leave;e||n||rt.context({leave:!0});var i=et({leave:n,reverse:e}),r=A,o=[{value:r[0].pageviews[r[0].pageviews.length-1],title:"Lemonade is released",wrap:150,padding:.5*l,dx:x?-25:-50,dy:50,r:1.25*m}],a=W(),s=F();$({scaleX:a,scaleY:s,dur:{slow:0}});var c=Y.selectAll(".person").data(r,function(t){return t.pageid}),u=c.enter().append("g.person").call(G).merge(c);u.call(Q,{scaleX:a,scaleY:s}),u.call(Z,{scaleX:a,scaleY:s}),u.classed("is-highlight",!0),u.selectAll("circle").filter(function(t){return"20160425"===t.timestamp}).transition().duration(i.fast).ease(_).at("r",m).st("stroke-width",m/2).at("transform",function(t){return"translate("+a(t.date)+", "+s(t.views_adjusted)+")"}),it({scaleX:a,scaleY:s,annoData:o,dur:i.fast}),J(c,i.fast)},"prince-before":function(t){var e=t.reverse,n=t.leave;e||n||rt.lemonade({leave:!0});var r=et({leave:n,reverse:e}),o=tt(h),a=M.filter(function(t){return t.pageid===f}).map(function(t){return i({},t,{pageviews:K(t.pageviews,{start:o,end:-1})})}).concat(A),s=W(),c=F();$({scaleX:s,scaleY:c,dur:r});var u=Y.selectAll(".person").data(a,function(t){return t.pageid}),l=u.enter().append("g.person").call(G).merge(u);l.call(Z,{scaleX:s,scaleY:c,r:g}),l.call(Q,{scaleX:s,scaleY:c,render:!e});var d=V({scaleX:s,scaleY:c});if(e)l.selectAll("path").transition().duration(r.slow).ease(_).at("d",d).at("stroke-dashoffset",0).st("opacity",1),l.selectAll("circle").transition().duration(r.slow).ease(_).st("opacity",1).at("r",g).at("transform",function(t){return"translate("+s(t.date)+", "+c(t.views_adjusted)+")"});else{var p=l.filter(function(t){return t.pageid===f}),y=l.filter(function(t){return"beyonce"===t.pageid});p.call(U);var v=[0],x=a.find(function(t){return"beyonce"!==t.pageid}).pageviews;x.forEach(function(t,e){if(0===e)return null;var n=x[e-1],i=L.append("path.temp").datum([n,t]).at("d",d),r=v[e-1]+i.node().getTotalLength();v.push(r),i.remove()});var b=p.selectAll("path").node().getTotalLength();p.selectAll("circle").at("r",0),p.selectAll("path").transition().duration(r.slow).ease(_).tween("stroke-dashoffset",function(t,e,n){var i=d3.select(n[e]),r=d3.interpolate(b,0);return function(t){var e=r(t),n=v.filter(function(t){return t<=b-e});!function(t){p.selectAll("circle").filter(function(e,n){return n<t}).at("r",function(t){return 0===t.bin_death_index?m:g}).st("stroke-width",function(t){return 0===t.bin_death_index?m/2:g/2})}(x.slice(0,n.length).length),i.at("stroke-dashoffset",e)}}),y.selectAll("circle").transition().duration(r.fast).ease(_).at("r",g).st("stroke-width",g/2)}it({scaleX:s,scaleY:c,annoData:[]}),l.classed("is-highlight",function(t){return t.pageid===f}),l.filter(function(t){return t.pageid===f}).raise(),J(u,r.fast)},"prince-spike":function(t){var e=t.reverse,n=t.leave;e||n||rt["prince-before"]({leave:!0});var r=et({leave:n,reverse:e}),o=tt(h),a=M.filter(function(t){return t.pageid===f}).map(function(t){return i({},t,{pageviews:K(t.pageviews,{start:o,end:0})})}).concat(A),s=a.find(function(t){return t.pageid===f}).pageviews,c=W(),u=F(s);$({scaleX:c,scaleY:u,dur:r});var l=Y.selectAll(".person").data(a,function(t){return t.pageid}),d=l.enter().append("g.person").call(G).merge(l),p=function(){var t=d.filter(function(t){return t.pageid===f}),i=t.selectAll("path").node().getTotalLength();t.call(Q,{scaleX:c,scaleY:u}),t.call(Z,{scaleX:c,scaleY:u,r:0}),n||e||t.call(U,i),t.selectAll("path").transition().duration(n?0:r.slow).ease(d3.easeCubicIn).at("stroke-dashoffset",0),t.selectAll("circle").transition().duration(r.fast).delay(n?0:r.slow-50).ease(_).at("r",function(t){return 0===t.bin_death_index?m:g}).st("stroke-width",function(t){return 0===t.bin_death_index?m/2:g/2})},y=V({scaleX:c,scaleY:u});e?(d.call(Z,{scaleX:c,scaleY:u,r:0}),d.call(Q,{scaleX:c,scaleY:u,render:!e}),d.selectAll("path").at("d",y).at("opacity",0).at("stroke-dashoffset",0).at("stroke-dasharray","0 0").transition().duration(r.fast).delay(r.slow).ease(_).st("opacity",1),d.selectAll("circle").transition().duration(r.slow).delay(function(t){return"beyonce"===t.pageid?r.slow:0}).ease(_).st("opacity",1).at("r",function(t){return 0===t.bin_death_index?m:g}).at("transform",function(t){return"translate("+c(t.date)+", "+u(t.views_adjusted)+")"}).st("stroke-width",function(t){return 0===t.bin_death_index?m/2:g/2})):(d.selectAll("path").transition().duration(r.slow).ease(_).at("d",y).st("opacity",1).on("end",function(t){t[0].pageid!==f||n||p()}),d.selectAll("circle").transition().duration(r.slow).ease(_).st("opacity",1).at("transform",function(t){return"translate("+c(t.date)+", "+u(t.views_adjusted)+")"}).st("stroke-width",function(t){return 0===t.bin_death_index?m/2:g/2})),d.selectAll("text").transition().duration(r.fast).ease(_).st("opacity",0),d.classed("is-highlight",function(t){return t.pageid===f}),d.filter(function(t){return t.pageid===f}).raise(),it({scaleX:c,scaleY:u,annoData:[]}),J(l),n&&!e&&p()},others:function(t){var e=t.reverse,n=t.leave;e||n||rt["prince-spike"]({leave:!0}),s.default.hide(z);var r=et({leave:n,reverse:e}),o=M.map(function(t){return i({},t,{pageviews:K(t.pageviews,{start:0,end:0})})});o.sort(function(t,e){return d3.descending(t.death_views_adjusted_2,e.death_views_adjusted_2)});var a=W(k),c=F(k),u=function(t){return d3.scaleSqrt().domain(d3.extent(t,function(t){return t.death_views_adjusted_2})).nice().range([g,m])}(o);$({scaleX:a,scaleY:c,dur:r,ticks:null}),o.sort(function(t,e){return d3.ascending(+t.timestamp_of_death,+e.timestamp_of_death)});var l=Y.selectAll(".person").data(o,function(t){return t.pageid}),h=l.enter().append("g.person").call(G),d=function(){var t=h.merge(l);t.call(Z,{scaleX:a,scaleY:c,r:0}),t.selectAll("circle").classed("is-active",!1).transition().duration(r.medium).delay(function(t){var e=M.find(function(e){return e.pageid===t.pageid}).index;return r.slow*(e/M.length)}).ease(_).at("r",function(t){return u(t.views_adjusted)}).at("stroke-width",g/2),t.selectAll("text").at("transform",function(t){return"translate("+a(t.pageviews[0].date)+", "+(c(t.pageviews[0].views_adjusted)-u(1.5*t.pageviews[0].views_adjusted))+")"}).transition().duration(r.medium).delay(function(t){if(e)return 0;var n=M.find(function(e){return e.pageid===t.pageid}).index;return r.slow*(n/M.length)}).ease(_).st("opacity",function(t){var e=+t.timestamp_of_death.substring(0,4),n=+t.timestamp_of_death.substring(4,6)-1,i=new Date(2018,2),r=new Date(e,n);return x&&"Antonin Scalia"===t.display?0:x&&t.perspective_show&&r<i?1:!x&&t.perspective_show?1:0}),t.filter(function(t){return t.perspective_show}).raise(),t.selectAll(".is-not-death-index").classed("is-transparent",!0)},p=V({scaleX:a,scaleY:c});l.selectAll("path").transition().duration(r.fast).ease(_).st("opacity",0).on("end",function(t,e,n){return d3.select(n[e]).at("d",p)}),l.selectAll("circle").transition().duration(e?0:r.medium).ease(_).st("opacity",function(t){return 0===t.bin_death_index?1:0}).at("transform",function(t){return"translate("+a(t.date)+", "+c(t.views_adjusted)+")"}).on("end",function(t){t&&t.pageid===f&&!n&&d()}),l.classed("is-highlight",!1),it({scaleX:a,scaleY:c,annoData:[]}),J(l,r.fast),n&&!e&&d()},compare:function(t){var e=t.reverse,n=t.leave;e||n||rt.others({leave:!0});var r=et({leave:n,reverse:e}),o=M.map(function(t){return i({},t,{pageviews:K(t.pageviews,{start:-50,end:0})})}),a=[{value:{date:new Date(2016,5,20),views_adjusted:1363178.6545344382},title:"LeBron James (NBA Finals)",padding:0,dx:Math.floor(.01*b),dy:-Math.floor(.07*b),r:m/2},{value:{date:new Date(2017,0,20),views_adjusted:3398306.903546566},title:"Donald Trump (inauguration)",padding:0,dx:Math.floor(.02*b),dy:-Math.floor(.03*b),r:m/2},{value:{date:new Date(2018,4,19),views_adjusted:4277840.230891479},title:" Meghan Markle (royal wedding)",padding:0,dx:-Math.floor(.05*b),dy:-Math.floor(.05*b),r:m/2}];a=a.filter(function(t,e){return!x||1!==e}),o.sort(function(t,e){return d3.descending(t.death_views_adjusted_2,e.death_views_adjusted_2)});var s=W(k),c=F(k);$({scaleX:s,scaleY:c,dur:r,ticks:null}),o.sort(function(t,e){return d3.ascending(+t.timestamp_of_death,+e.timestamp_of_death)});var l=Y.selectAll(".person").data(o,function(t){return t.pageid});l.enter().append("g.person").call(G),l.selectAll("path").transition().duration(r.slow).ease(_).st("opacity",0),l.selectAll("circle").transition().duration(r.slow).ease(_).st("opacity",function(t){return 0===t.bin_death_index?1:0}).at("transform",function(t){return"translate("+s(t.date)+", "+c(t.views_adjusted)+")"}),l.selectAll("text").transition().duration(r.fast).ease(_).st("opacity",0),l.classed("is-highlight",!1),l.exit().transition().duration(r.fast).st("opacity",0).remove(),it(n&&!e?{scaleX:s,scaleY:c,annoData:[]}:{scaleX:s,scaleY:c,annoData:a}),H.x(function(t){return s(t.date)}).y(function(t){return c(t.views_adjusted)}).extent([[-u.left,-u.top],[b+u.left,w+u.top]]);var f=I.selectAll("path"),h=o.map(function(t){return t.pageviews.find(function(t){return 0===t.bin_death_index})}),d=H.polygons(h);f.data(d).enter().append("path").merge(f).at("d",function(t){return t?"M"+t.join("L")+"Z":null}),x?f.on("click",nt):f.on("mouseenter",nt),J(l,r.fast)}};function ot(t){var e=t.reverse,n=void 0===e||e,i=t.leave,r=void 0!==i&&i;rt[O]&&rt[O]({reverse:n,leave:r}),X.classed("is-visible","compare"===O)}function at(){!function(){j=window.innerHeight,(x=d3.select("body").node().offsetWidth<v)&&(u.right=10),g=x?2:4,m=x?8:16;var t=x?.7:.8;w=Math.floor(j*t)-u.top-u.bottom,b=C.node().offsetWidth-u.left-u.right}(),N.st({height:j,top:x?0:y,"padding-bottom":x?0:y}),L.at({width:b+u.left+u.right,height:w+u.top+u.bottom}),R.at("transform","translate("+u.left+", "+u.top+")"),I.at("transform","translate("+u.left+", "+u.top+")");var t=P.size();P.st("padding-bottom",j),P.filter(function(t,e){return 0===e}).st("margin-top",.67*-j),P.filter(function(e,n){return n===t-1}).st("padding-bottom",.9*j),E.select(".step-hover").st("padding-bottom",.4*j),q.resize(),ot({reverse:!1,leave:!0})}e.default={init:function(t){(function(t){return new Promise(function(e,n){var r,o=["perspective","beyonce"].map(function(t){return"assets/data/"+t+".csv"});(r=d3).loadData.apply(r,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(o).concat([function(r,o){r&&n(r),k=a.default.pageview(o[0]),M=t.map(function(t){return i({},t,{pageviews:k.filter(function(e){return e.pageid===t.pageid})})});var s=a.default.pageview(o[1]);A=[{pageid:"beyonce",pageviews:s.filter(function(t){return t.date>=h&&t.date<d})}],e()}]))})})(t).then(function(){at(),z=s.default.init({container:C}),x?z[0].select(".close").on("click",s.default.hide(z)):L.on("mouseleave",function(){s.default.hide(z)}),function(){S=!0,C.classed("is-hover",!0),E.classed("is-disabled",!0),D.classed("is-onscreen",!0);var t=0,e=["context","lemonade","prince-before","prince-spike","others","compare"];window.addEventListener("keyup",function(n){var i="ArrowLeft"===n.key?-1:1;t+=i,t=Math.min(Math.max(0,t),e.length-1),O=e[t],ot({reverse:-1===i,leave:!1})})}()})},resize:at,filter:function(t){var e=t.name,n=t.value,i=Y.selectAll(".person");e?i.classed("is-faded",function(t){return!t[e].includes(n)}):i.classed("is-faded",!1)}}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){(function(t,n){var i="Expected a function",r="__lodash_hash_undefined__",o=1,a=2,s=1/0,c=9007199254740991,u="[object Arguments]",l="[object Array]",f="[object Boolean]",h="[object Date]",d="[object Error]",p="[object Function]",_="[object GeneratorFunction]",y="[object Map]",v="[object Number]",g="[object Object]",m="[object RegExp]",x="[object Set]",b="[object String]",w="[object Symbol]",j="[object ArrayBuffer]",M="[object DataView]",k=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/,O=/^\./,S=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,T=/\\(\\)?/g,E=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[u]=N[l]=N[j]=N[f]=N[M]=N[h]=N[d]=N[p]=N[y]=N[v]=N[g]=N[m]=N[x]=N[b]=N["[object WeakMap]"]=!1;var C="object"==typeof t&&t&&t.Object===Object&&t,L="object"==typeof self&&self&&self.Object===Object&&self,R=C||L||Function("return this")(),B="object"==typeof e&&e&&!e.nodeType&&e,I=B&&"object"==typeof n&&n&&!n.nodeType&&n,Y=I&&I.exports===B&&C.process,X=function(){try{return Y&&Y.binding("util")}catch(t){}}(),D=X&&X.isTypedArray;function z(t,e){return!(!t||!t.length)&&function(t,e,n){if(e!=e)return function(t,e,n,i){for(var r=t.length,o=-1;++o<r;)if(e(t[o],o,t))return o;return-1}(t,H);for(var i=-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}(t,e)>-1}function q(t,e){for(var n=-1,i=t?t.length:0;++n<i;)if(e(t[n],n,t))return!0;return!1}function H(t){return t!=t}function W(t,e){return t.has(e)}function F(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function V(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n}function $(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var U=Array.prototype,G=Function.prototype,J=Object.prototype,Z=R["__core-js_shared__"],Q=function(){var t=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),K=G.toString,tt=J.hasOwnProperty,et=J.toString,nt=RegExp("^"+K.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),it=R.Symbol,rt=R.Uint8Array,ot=J.propertyIsEnumerable,at=U.splice,st=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),ct=Rt(R,"DataView"),ut=Rt(R,"Map"),lt=Rt(R,"Promise"),ft=Rt(R,"Set"),ht=Rt(R,"WeakMap"),dt=Rt(Object,"create"),pt=Ht(ct),_t=Ht(ut),yt=Ht(lt),vt=Ht(ft),gt=Ht(ht),mt=it?it.prototype:void 0,xt=mt?mt.valueOf:void 0,bt=mt?mt.toString:void 0;function wt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function jt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Mt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function kt(t){var e=-1,n=t?t.length:0;for(this.__data__=new Mt;++e<n;)this.add(t[e])}function At(t){this.__data__=new jt(t)}function Ot(t,e){for(var n=t.length;n--;)if(Ft(t[n][0],e))return n;return-1}function St(t,e){for(var n=0,i=(e=Yt(e,t)?[e]:Pt(e)).length;null!=t&&n<i;)t=t[qt(e[n++])];return n&&n==i?t:void 0}function Tt(t,e){return null!=t&&e in Object(t)}function Et(t,e,n,i,r){return t===e||(null==t||null==e||!Zt(t)&&!Qt(e)?t!=t&&e!=e:function(t,e,n,i,r,s){var c=$t(t),p=$t(e),_=l,k=l;c||(_=(_=Bt(t))==u?g:_),p||(k=(k=Bt(e))==u?g:k);var A=_==g&&!F(t),O=k==g&&!F(e),S=_==k;if(S&&!A)return s||(s=new At),c||te(t)?Ct(t,e,n,i,r,s):function(t,e,n,i,r,s,c){switch(n){case M:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case j:return!(t.byteLength!=e.byteLength||!i(new rt(t),new rt(e)));case f:case h:case v:return Ft(+t,+e);case d:return t.name==e.name&&t.message==e.message;case m:case b:return t==e+"";case y:var u=V;case x:var l=s&a;if(u||(u=$),t.size!=e.size&&!l)return!1;var p=c.get(t);if(p)return p==e;s|=o,c.set(t,e);var _=Ct(u(t),u(e),i,r,s,c);return c.delete(t),_;case w:if(xt)return xt.call(t)==xt.call(e)}return!1}(t,e,_,n,i,r,s);if(!(r&a)){var T=A&&tt.call(t,"__wrapped__"),E=O&&tt.call(e,"__wrapped__");if(T||E){var P=T?t.value():t,N=E?e.value():e;return s||(s=new At),n(P,N,i,r,s)}}return!!S&&(s||(s=new At),function(t,e,n,i,r,o){var s=r&a,c=ee(t),u=c.length;if(u!=ee(e).length&&!s)return!1;for(var l=u;l--;){var f=c[l];if(!(s?f in e:tt.call(e,f)))return!1}var h=o.get(t);if(h&&o.get(e))return h==e;var d=!0;o.set(t,e),o.set(e,t);for(var p=s;++l<u;){var _=t[f=c[l]],y=e[f];if(i)var v=s?i(y,_,f,e,t,o):i(_,y,f,t,e,o);if(!(void 0===v?_===y||n(_,y,i,r,o):v)){d=!1;break}p||(p="constructor"==f)}if(d&&!p){var g=t.constructor,m=e.constructor;g!=m&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(d=!1)}return o.delete(t),o.delete(e),d}(t,e,n,i,r,s))}(t,e,Et,n,i,r))}function Pt(t){return $t(t)?t:zt(t)}wt.prototype.clear=function(){this.__data__=dt?dt(null):{}},wt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},wt.prototype.get=function(t){var e=this.__data__;if(dt){var n=e[t];return n===r?void 0:n}return tt.call(e,t)?e[t]:void 0},wt.prototype.has=function(t){var e=this.__data__;return dt?void 0!==e[t]:tt.call(e,t)},wt.prototype.set=function(t,e){return this.__data__[t]=dt&&void 0===e?r:e,this},jt.prototype.clear=function(){this.__data__=[]},jt.prototype.delete=function(t){var e=this.__data__,n=Ot(e,t);return!(n<0||(n==e.length-1?e.pop():at.call(e,n,1),0))},jt.prototype.get=function(t){var e=this.__data__,n=Ot(e,t);return n<0?void 0:e[n][1]},jt.prototype.has=function(t){return Ot(this.__data__,t)>-1},jt.prototype.set=function(t,e){var n=this.__data__,i=Ot(n,t);return i<0?n.push([t,e]):n[i][1]=e,this},Mt.prototype.clear=function(){this.__data__={hash:new wt,map:new(ut||jt),string:new wt}},Mt.prototype.delete=function(t){return Lt(this,t).delete(t)},Mt.prototype.get=function(t){return Lt(this,t).get(t)},Mt.prototype.has=function(t){return Lt(this,t).has(t)},Mt.prototype.set=function(t,e){return Lt(this,t).set(t,e),this},kt.prototype.add=kt.prototype.push=function(t){return this.__data__.set(t,r),this},kt.prototype.has=function(t){return this.__data__.has(t)},At.prototype.clear=function(){this.__data__=new jt},At.prototype.delete=function(t){return this.__data__.delete(t)},At.prototype.get=function(t){return this.__data__.get(t)},At.prototype.has=function(t){return this.__data__.has(t)},At.prototype.set=function(t,e){var n=this.__data__;if(n instanceof jt){var i=n.__data__;if(!ut||i.length<199)return i.push([t,e]),this;n=this.__data__=new Mt(i)}return n.set(t,e),this};var Nt=ft&&1/$(new ft([,-0]))[1]==s?function(t){return new ft(t)}:function(){};function Ct(t,e,n,i,r,s){var c=r&a,u=t.length,l=e.length;if(u!=l&&!(c&&l>u))return!1;var f=s.get(t);if(f&&s.get(e))return f==e;var h=-1,d=!0,p=r&o?new kt:void 0;for(s.set(t,e),s.set(e,t);++h<u;){var _=t[h],y=e[h];if(i)var v=c?i(y,_,h,e,t,s):i(_,y,h,t,e,s);if(void 0!==v){if(v)continue;d=!1;break}if(p){if(!q(e,function(t,e){if(!p.has(e)&&(_===t||n(_,t,i,r,s)))return p.add(e)})){d=!1;break}}else if(_!==y&&!n(_,y,i,r,s)){d=!1;break}}return s.delete(t),s.delete(e),d}function Lt(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map}function Rt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Zt(t)||function(t){return!!Q&&Q in t}(t))&&(Gt(t)||F(t)?nt:E).test(Ht(t))}(n)?n:void 0}var Bt=function(t){return et.call(t)};function It(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||P.test(t))&&t>-1&&t%1==0&&t<e}function Yt(t,e){if($t(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Kt(t))||A.test(t)||!k.test(t)||null!=e&&t in Object(e)}function Xt(t){return t==t&&!Zt(t)}function Dt(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}(ct&&Bt(new ct(new ArrayBuffer(1)))!=M||ut&&Bt(new ut)!=y||lt&&"[object Promise]"!=Bt(lt.resolve())||ft&&Bt(new ft)!=x||ht&&"[object WeakMap]"!=Bt(new ht))&&(Bt=function(t){var e=et.call(t),n=e==g?t.constructor:void 0,i=n?Ht(n):void 0;if(i)switch(i){case pt:return M;case _t:return y;case yt:return"[object Promise]";case vt:return x;case gt:return"[object WeakMap]"}return e});var zt=Wt(function(t){t=function(t){return null==t?"":function(t){if("string"==typeof t)return t;if(Kt(t))return bt?bt.call(t):"";var e=t+"";return"0"==e&&1/t==-s?"-0":e}(t)}(t);var e=[];return O.test(t)&&e.push(""),t.replace(S,function(t,n,i,r){e.push(i?r.replace(T,"$1"):n||t)}),e});function qt(t){if("string"==typeof t||Kt(t))return t;var e=t+"";return"0"==e&&1/t==-s?"-0":e}function Ht(t){if(null!=t){try{return K.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Wt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(i);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=t.apply(this,i);return n.cache=o.set(r,a),a};return n.cache=new(Wt.Cache||Mt),n}function Ft(t,e){return t===e||t!=t&&e!=e}function Vt(t){return function(t){return Qt(t)&&Ut(t)}(t)&&tt.call(t,"callee")&&(!ot.call(t,"callee")||et.call(t)==u)}Wt.Cache=Mt;var $t=Array.isArray;function Ut(t){return null!=t&&Jt(t.length)&&!Gt(t)}function Gt(t){var e=Zt(t)?et.call(t):"";return e==p||e==_}function Jt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function Zt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Qt(t){return!!t&&"object"==typeof t}function Kt(t){return"symbol"==typeof t||Qt(t)&&et.call(t)==w}var te=D?function(t){return function(e){return t(e)}}(D):function(t){return Qt(t)&&Jt(t.length)&&!!N[et.call(t)]};function ee(t){return Ut(t)?function(t,e){var n=$t(t)||Vt(t)?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],i=n.length,r=!!i;for(var o in t)!e&&!tt.call(t,o)||r&&("length"==o||It(o,i))||n.push(o);return n}(t):function(t){if(!function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||J)}(t))return st(t);var e=[];for(var n in Object(t))tt.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}function ne(t){return t}n.exports=function(t,e){return t&&t.length?function(t,e,n){var i=-1,r=z,o=t.length,a=!0,s=[],c=s;if(o>=200){var u=e?null:Nt(t);if(u)return $(u);a=!1,r=W,c=new kt}else c=e?[]:s;t:for(;++i<o;){var l=t[i],f=e?e(l):l;if(l=0!==l?l:0,a&&f==f){for(var h=c.length;h--;)if(c[h]===f)continue t;e&&c.push(f),s.push(l)}else r(c,f,n)||(c!==s&&c.push(f),s.push(l))}return s}(t,function(t){return"function"==typeof t?t:null==t?ne:"object"==typeof t?$t(t)?function(t,e){return Yt(t)&&Xt(e)?Dt(qt(t),e):function(n){var i=function(t,e,n){var i=null==t?void 0:St(t,e);return void 0===i?void 0:i}(n,t);return void 0===i&&i===e?function(t,e){return null!=n&&function(t,e,n){for(var i,r=-1,o=(e=Yt(e,t)?[e]:Pt(e)).length;++r<o;){var a=qt(e[r]);if(!(i=null!=t&&n(t,a)))break;t=t[a]}return i||!!(o=t?t.length:0)&&Jt(o)&&It(a,o)&&($t(t)||Vt(t))}(n,e,Tt)}(0,t):Et(e,i,void 0,o|a)}}(t[0],t[1]):function(t){var e=function(t){for(var e=ee(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,Xt(r)]}return e}(t);return 1==e.length&&e[0][2]?Dt(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,i){var r=n.length,s=r;if(null==t)return!s;for(t=Object(t);r--;){var c=n[r];if(c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++r<s;){var u=(c=n[r])[0],l=t[u],f=c[1];if(c[2]){if(void 0===l&&!(u in t))return!1}else{var h,d=new At;if(!(void 0===h?Et(f,l,i,o|a,d):h))return!1}}return!0}(n,0,e)}}(t):function(t){return Yt(t)?function(t){return function(e){return null==e?void 0:e[t]}}(qt(t)):function(t){return function(e){return St(e,t)}}(t)}(t)}(e)):[]}}).call(this,n(7),n(8)(t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=t.name,r=t.data,o=n.toLowerCase(),a=(0,i.default)((e=[]).concat.apply(e,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(r.map(function(t){return t[o]}))));a.sort(d3.ascending),u.select(".filter--"+o+" ul").selectAll("li").data(a).enter().append("li").text(function(t){return t}).at("data-name",n).on("click",d)};var i=c(n(9)),r=c(n(6)),o=c(n(4)),a=c(n(3)),s=c(n(2));function c(t){return t&&t.__esModule?t:{default:t}}var u=d3.select(".filters"),l=u.select(".label"),f=u.select(".remove"),h=l.select(".label__value");function d(){var t=d3.select(this),e=t.text(),n=t.at("data-name");h.html(n+": "+e),u.classed("is-visible",!1),u.classed("is-active",!0),o.default.filter({name:n.toLowerCase(),value:e}),a.default.filter({name:n.toLowerCase(),value:e}),s.default.filter({name:n.toLowerCase(),value:e}),r.default.filter({name:n.toLowerCase(),value:e})}l.on("click",function(){var t=!u.classed("is-visible");u.classed("is-visible",t)}),f.on("click",function(){h.html(""),u.classed("is-visible",!1),u.classed("is-active",!1),o.default.filter({}),a.default.filter({}),s.default.filter({}),r.default.filter({})})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=new Image;n.onload=function(){return e(null,n)},n.onerror=function(){return e("error loading image: "+t)},n.src=t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=0;!function n(){var r=t[e].thumbnail_source;(0,i.default)(r,function(){(e+=1)<t.length&&n()})}()};var i=function(t){return t&&t.__esModule?t:{default:t}}(n(11))},function(t,e,n){"use strict";var i;function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.default={primary:(i={hex:"#008080"},r(i,"hex","#ff4500"),r(i,"hex","#5b5b5b"),r(i,"rgb",[0,128,128]),r(i,"rgb",[255,69,0]),r(i,"rgb",[91,91,91]),i)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.text,n=t.chars,i=void 0===n?100:n,r=t.clean,o=void 0===r||r,a=t.ellipses,s=void 0!==a&&a,c=e.length>i,u=e.substring(0,i),l=o?u.lastIndexOf(" "):u.length;return(c?u.substring(0,l):e)+(c&&s?"...":"")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.substring(0,4),n=+t.substring(4,6)-1,i=t.substring(6,8);return new Date(e,n,i)}},function(t,e,n){t.exports=function(){"use strict";function t(t){for(var e=t.length,n=[],i=0;i<e;i+=1)n.push(t[i]);return n}function e(t){return t instanceof Element?t:"string"==typeof t?document.querySelector(t):null}function n(t){return"scrollama__debug-offset--"+t.id}function i(t){!function(t){var e=t.id,i=t.offsetVal,r=t.stepClass,o=document.createElement("div");o.setAttribute("id",n({id:e})),o.setAttribute("class","scrollama__debug-offset"),o.style.position="fixed",o.style.left="0",o.style.width="100%",o.style.height="0px",o.style.borderTop="2px dashed black",o.style.zIndex="9999";var a=document.createElement("p");a.innerText='".'+r+'" trigger: '+i,a.style.fontSize="12px",a.style.fontFamily="monospace",a.style.color="black",a.style.margin="0",a.style.padding="6px",o.appendChild(a),document.body.appendChild(o)}({id:t.id,offsetVal:t.offsetVal,stepClass:t.stepEl[0].getAttribute("class")})}function r(t){var e=t.id,i=(t.stepOffsetHeight,t.offsetMargin);t.offsetVal,function(t){var e=t.offsetMargin,i=n({id:t.id});document.querySelector("#"+i).style.top=e+"px"}({id:e,offsetMargin:i})}function o(t){var e=t.id,n=t.index,i=t.state,r=function(t){return"scrollama__debug-step--"+t.id+"-"+t.i}({id:e,i:n}),o=document.querySelector("#"+r+"_above"),a=document.querySelector("#"+r+"_below"),s="enter"===i?"block":"none";o&&(o.style.display=s),a&&(a.style.display=s)}return function(){var n=1,a={},s={},c=null,u=null,l=null,f=null,h=0,d=0,p=0,_=0,y=null,v=null,g=null,m=!1,x=!1,b=!1,w=!1,j=0,M=!1,k=!1,A=null,O=null,S=-1,T=null,E=[];function P(t){var e=0;if(t.offsetParent)do{e+=t.offsetTop,t=t.offsetParent}while(t);return e<0?0:e}function N(t){return+t.getAttribute("data-scrollama-index")}function C(){window.pageYOffset>S?T="down":window.pageYOffset<S&&(T="up"),S=window.pageYOffset}function L(){p=window.innerHeight,_=function(){var t=document.body,e=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)}(),g=u?u.getBoundingClientRect():null,d=h*p,y=l?l.map(function(t){return t.offsetHeight}):[],v=l?l.map(P):[],x&&m&&G(),b&&r({id:f,stepOffsetHeight:y,offsetMargin:d,offsetVal:h})}function R(t){t&&!x?(m&&G(),x=!0):t||(s.top&&s.top.disconnect(),s.bottom&&s.bottom.disconnect(),s.stepAbove&&s.stepAbove.forEach(function(t){return t.disconnect()}),s.stepBelow&&s.stepBelow.forEach(function(t){return t.disconnect()}),s.stepProgress&&s.stepProgress.forEach(function(t){return t.disconnect()}),s.viewportAbove&&s.viewportAbove.forEach(function(t){return t.disconnect()}),s.viewportBelow&&s.viewportBelow.forEach(function(t){return t.disconnect()}),x=!1)}function B(t,e){if("above"===e)for(var n=0;n<t;n++){var i=A[n];"enter"===i.state&&Y(l[n],"down"),"up"===i.direction&&(I(l[n],"down",!1),Y(l[n],"down"))}else if("below"===e)for(var r=A.length-1;r>t;r--){var o=A[r];"enter"===o.state&&Y(l[r],"up"),"down"===o.direction&&(I(l[r],"up",!1),Y(l[r],"up"))}}function I(t,e,n){void 0===n&&(n=!0);var i=N(t),r={element:t,index:i,direction:e};A[i].direction=e,A[i].state="enter",M&&n&&"down"===e&&B(i,"above"),M&&n&&"up"===e&&B(i,"below"),a.stepEnter&&"function"==typeof a.stepEnter&&!E[i]&&(a.stepEnter(r,A),b&&o({id:f,index:i,state:"enter"}),k&&(E[i]=!0)),w&&X(t,"down"===e?0:1)}function Y(t,e){var n=N(t),i={element:t,index:n,direction:e};A[n].direction=e,A[n].state="exit",w&&X(t,"down"===e?1:0),a.stepExit&&"function"==typeof a.stepExit&&(a.stepExit(i,A),b&&o({id:f,index:n,state:"exit"}))}function X(t,e){var n={element:t,index:N(t),progress:e};a.stepProgress&&"function"==typeof a.stepProgress&&a.stepProgress(n)}function D(){var t={direction:T};O.direction=T,O.state="enter",a.containerEnter&&"function"==typeof a.containerEnter&&a.containerEnter(t)}function z(){var t={direction:T};O.direction=T,O.state="exit",a.containerExit&&"function"==typeof a.containerExit&&a.containerExit(t)}function q(t){C(),t.forEach(function(t){var e=t.isIntersecting,i=t.boundingClientRect,r=t.target,o=i.bottom,a=i.height,s=o-d,c=N(r),u=A[c];s>=-n&&(e&&"down"===T&&"enter"!==u.state?I(r,T):e||"up"!==T||"enter"!==u.state?!e&&s>=a&&"down"===T&&"enter"===u.state&&Y(r,T):Y(r,T))})}function H(t){C(),t.forEach(function(t){var e=t.isIntersecting,i=t.boundingClientRect,r=t.target,o=i.bottom,a=i.height,s=o-d,c=N(r),u=A[c];s>=-n&&s<a&&e&&"up"===T&&"enter"!==u.state?I(r,T):s<=n&&!e&&"down"===T&&"enter"===u.state&&Y(r,T)})}function W(t){C(),t.forEach(function(t){var e=t.isIntersecting,n=t.target,i=N(n),r=A[i];e&&"down"===T&&"enter"!==r.state&&"down"!==r.direction&&(I(n,"down"),Y(n,"down"))})}function F(t){C(),t.forEach(function(t){var e=t.isIntersecting,n=t.target,i=N(n),r=A[i];e&&"up"===T&&"enter"!==r.state&&"up"!==r.direction&&(I(n,"up"),Y(n,"up"))})}function V(t){C(),t.forEach(function(t){var e=t.isIntersecting,i=t.intersectionRatio,r=t.boundingClientRect,o=t.target,a=r.bottom;e&&a-d>=-n&&X(o,+i.toFixed(3))})}function $(t){C();var e=t[0],i=e.isIntersecting,r=e.boundingClientRect;(r.top,r.bottom)>-n&&(i?D():"enter"===O.state&&z())}function U(t){C();var e=t[0],i=e.isIntersecting;e.boundingClientRect.top<n&&(i?D():"enter"===O.state&&z())}function G(){s.viewportAbove&&s.viewportAbove.forEach(function(t){return t.disconnect()}),s.viewportAbove=l.map(function(t,e){var n=v[e],i=-(p-d+y[e]),r=new IntersectionObserver(W,{root:null,rootMargin:n+"px 0px "+i+"px 0px",threshold:0});return r.observe(t),r}),s.viewportBelow&&s.viewportBelow.forEach(function(t){return t.disconnect()}),s.viewportBelow=l.map(function(t,e){var n=-(d+y[e]),i=_-v[e]-y[e]-d,r=new IntersectionObserver(F,{root:null,rootMargin:n+"px 0px "+i+"px 0px",threshold:0});return r.observe(t),r}),s.stepAbove&&s.stepAbove.forEach(function(t){return t.disconnect()}),s.stepAbove=l.map(function(t,e){var n=y[e],i=new IntersectionObserver(q,{root:null,rootMargin:n+"px 0px "+(-p+d)+"px 0px",threshold:0});return i.observe(t),i}),s.stepBelow&&s.stepBelow.forEach(function(t){return t.disconnect()}),s.stepBelow=l.map(function(t,e){var n=-d,i=_-p+y[e]+d,r=new IntersectionObserver(H,{root:null,rootMargin:n+"px 0px "+i+"px 0px",threshold:0});return r.observe(t),r}),w&&(s.stepProgress&&s.stepProgress.forEach(function(t){return t.disconnect()}),s.stepProgress=l.map(function(t,e){var n=y[e]-d+"px 0px "+(-p+d)+"px 0px",i=function(t){for(var e=Math.ceil(t/j),n=[],i=1/e,r=0;r<e;r++)n.push(r*i);return n}(y[e]),r=new IntersectionObserver(V,{root:null,rootMargin:n,threshold:i});return r.observe(t),r})),c&&u&&(function(){s.top&&s.top.unobserve(c);var t={root:null,rootMargin:p+"px 0px -"+p+"px 0px",threshold:0};s.top=new IntersectionObserver($,t),s.top.observe(c)}(),function(){s.bottom&&s.bottom.unobserve(c);var t={root:null,rootMargin:"-"+g.height+"px 0px "+g.height+"px 0px",threshold:0};s.bottom=new IntersectionObserver(U,t),s.bottom.observe(c)}())}var J={setup:function(n){var r=n.container,o=n.graphic,a=n.step,s=n.offset;void 0===s&&(s=.5);var d=n.progress;void 0===d&&(d=!1);var p=n.threshold;void 0===p&&(p=4);var _=n.debug;void 0===_&&(_=!1);var y=n.order;void 0===y&&(y=!0);var v=n.once;return void 0===v&&(v=!1),f=function(){var t="abcdefghijklmnopqrstuv",e=t.length,n=(new Date).getTime();return""+[0,0,0].map(function(n){return t[Math.floor(Math.random()*e)]}).join("")+n}(),l=function(e,n){return void 0===n&&(n=document),"string"==typeof e?t(n.querySelectorAll(e)):e instanceof NodeList?t(e):e instanceof Array?e:[]}(a),c=r?e(r):null,u=o?e(o):null,l.length?(b=_,w=d,M=y,k=v,J.offsetTrigger(s),j=Math.max(1,+p),m=!0,b&&i({id:f,stepEl:l,offsetVal:h}),l.forEach(function(t,e){return t.setAttribute("data-scrollama-index",e)}),A=l.map(function(){return{direction:null,state:null}}),O={direction:null,state:null},L(),R(!0),J):(console.error("scrollama error: no step elements"),J)},resize:function(){return L(),J},enable:function(){return R(!0),J},disable:function(){return R(!1),J},destroy:function(){R(!1),Object.keys(a).forEach(function(t){return a[t]=null}),Object.keys(s).forEach(function(t){return s[t]=null})},offsetTrigger:function(t){return t&&!isNaN(t)?(h=Math.min(Math.max(0,t),1),J):h},onStepEnter:function(t){return a.stepEnter=t,J},onStepExit:function(t){return a.stepExit=t,J},onStepProgress:function(t){return a.stepProgress=t,J},onContainerEnter:function(t){return a.containerEnter=t,J},onContainerExit:function(t){return a.containerExit=t,J}};return J}}()},function(t,e){!function(e,n){"use strict";var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=!1;if(e.getComputedStyle){var o=n.createElement("div");["","-webkit-","-moz-","-ms-"].some(function(t){try{o.style.position=t+"sticky"}catch(t){}return""!=o.style.position})&&(r=!0)}else r=!0;var a="undefined"!=typeof ShadowRoot,s={top:null,left:null},c=[];function u(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function l(t){return parseFloat(t)||0}function f(t){for(var e=0;t;)e+=t.offsetTop,t=t.offsetParent;return e}var h=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(e instanceof HTMLElement))throw new Error("First argument must be HTMLElement");if(c.some(function(t){return t._node===e}))throw new Error("Stickyfill is already applied to this node");this._node=e,this._stickyMode=null,this._active=!1,c.push(this),this.refresh()}return i(t,[{key:"refresh",value:function(){if(!r&&!this._removed){this._active&&this._deactivate();var t=this._node,i=getComputedStyle(t),o={top:i.top,display:i.display,marginTop:i.marginTop,marginBottom:i.marginBottom,marginLeft:i.marginLeft,marginRight:i.marginRight,cssFloat:i.cssFloat};if(!isNaN(parseFloat(o.top))&&"table-cell"!=o.display&&"none"!=o.display){this._active=!0;var s=t.parentNode,c=a&&s instanceof ShadowRoot?s.host:s,h=t.getBoundingClientRect(),d=c.getBoundingClientRect(),p=getComputedStyle(c);this._parent={node:c,styles:{position:c.style.position},offsetHeight:c.offsetHeight},this._offsetToWindow={left:h.left,right:n.documentElement.clientWidth-h.right},this._offsetToParent={top:h.top-d.top-l(p.borderTopWidth),left:h.left-d.left-l(p.borderLeftWidth),right:-h.right+d.right-l(p.borderRightWidth)},this._styles={position:t.style.position,top:t.style.top,bottom:t.style.bottom,left:t.style.left,right:t.style.right,width:t.style.width,marginTop:t.style.marginTop,marginLeft:t.style.marginLeft,marginRight:t.style.marginRight};var _=l(o.top);this._limits={start:h.top+e.pageYOffset-_,end:d.top+e.pageYOffset+c.offsetHeight-l(p.borderBottomWidth)-t.offsetHeight-_-l(o.marginBottom)};var y=p.position;"absolute"!=y&&"relative"!=y&&(c.style.position="relative"),this._recalcPosition();var v=this._clone={};v.node=n.createElement("div"),u(v.node.style,{width:h.right-h.left+"px",height:h.bottom-h.top+"px",marginTop:o.marginTop,marginBottom:o.marginBottom,marginLeft:o.marginLeft,marginRight:o.marginRight,cssFloat:o.cssFloat,padding:0,border:0,borderSpacing:0,fontSize:"1em",position:"static"}),s.insertBefore(v.node,t),v.docOffsetTop=f(v.node)}}}},{key:"_recalcPosition",value:function(){if(this._active&&!this._removed){var t=s.top<=this._limits.start?"start":s.top>=this._limits.end?"end":"middle";if(this._stickyMode!=t){switch(t){case"start":u(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:this._offsetToParent.top+"px",bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"middle":u(this._node.style,{position:"fixed",left:this._offsetToWindow.left+"px",right:this._offsetToWindow.right+"px",top:this._styles.top,bottom:"auto",width:"auto",marginLeft:0,marginRight:0,marginTop:0});break;case"end":u(this._node.style,{position:"absolute",left:this._offsetToParent.left+"px",right:this._offsetToParent.right+"px",top:"auto",bottom:0,width:"auto",marginLeft:0,marginRight:0})}this._stickyMode=t}}}},{key:"_fastCheck",value:function(){this._active&&!this._removed&&(Math.abs(f(this._clone.node)-this._clone.docOffsetTop)>1||Math.abs(this._parent.node.offsetHeight-this._parent.offsetHeight)>1)&&this.refresh()}},{key:"_deactivate",value:function(){var t=this;this._active&&!this._removed&&(this._clone.node.parentNode.removeChild(this._clone.node),delete this._clone,u(this._node.style,this._styles),delete this._styles,c.some(function(e){return e!==t&&e._parent&&e._parent.node===t._parent.node})||u(this._parent.node.style,this._parent.styles),delete this._parent,this._stickyMode=null,this._active=!1,delete this._offsetToWindow,delete this._offsetToParent,delete this._limits)}},{key:"remove",value:function(){var t=this;this._deactivate(),c.some(function(e,n){if(e._node===t._node)return c.splice(n,1),!0}),this._removed=!0}}]),t}(),d={stickies:c,Sticky:h,addOne:function(t){if(!(t instanceof HTMLElement)){if(!t.length||!t[0])return;t=t[0]}for(var e=0;e<c.length;e++)if(c[e]._node===t)return c[e];return new h(t)},add:function(t){if(t instanceof HTMLElement&&(t=[t]),t.length){for(var e=[],n=function(n){var i=t[n];return i instanceof HTMLElement?c.some(function(t){if(t._node===i)return e.push(t),!0})?"continue":void e.push(new h(i)):(e.push(void 0),"continue")},i=0;i<t.length;i++)n(i);return e}},refreshAll:function(){c.forEach(function(t){return t.refresh()})},removeOne:function(t){if(!(t instanceof HTMLElement)){if(!t.length||!t[0])return;t=t[0]}c.some(function(e){if(e._node===t)return e.remove(),!0})},remove:function(t){if(t instanceof HTMLElement&&(t=[t]),t.length)for(var e=function(e){var n=t[e];c.some(function(t){if(t._node===n)return t.remove(),!0})},n=0;n<t.length;n++)e(n)},removeAll:function(){for(;c.length;)c[0].remove()}};r||function(){function t(){e.pageXOffset!=s.left?(s.top=e.pageYOffset,s.left=e.pageXOffset,d.refreshAll()):e.pageYOffset!=s.top&&(s.top=e.pageYOffset,s.left=e.pageXOffset,c.forEach(function(t){return t._recalcPosition()}))}t(),e.addEventListener("scroll",t),e.addEventListener("resize",d.refreshAll),e.addEventListener("orientationchange",d.refreshAll);var i=void 0;function r(){i=setInterval(function(){c.forEach(function(t){return t._fastCheck()})},500)}var o=void 0,a=void 0;"hidden"in n?(o="hidden",a="visibilitychange"):"webkitHidden"in n&&(o="webkitHidden",a="webkitvisibilitychange"),a?(n[o]||r(),n.addEventListener(a,function(){n[o]?clearInterval(i):r()})):r()}(),void 0!==t&&t.exports?t.exports=d:e.Stickyfill=d}(window,document)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return i.android()||i.blackberry()||i.ios()||i.opera()||i.windows()}};e.default=i},function(t,e,n){(function(e){var n=NaN,i="[object Symbol]",r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt,u="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,f=u||l||Function("return this")(),h=Object.prototype.toString,d=Math.max,p=Math.min,_=function(){return f.Date.now()};function y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function v(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&h.call(t)==i}(t))return n;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var u=a.test(t);return u||s.test(t)?c(t.slice(2),u?2:8):o.test(t)?n:+t}t.exports=function(t,e,n){var i,r,o,a,s,c,u=0,l=!1,f=!1,h=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function g(e){var n=i,o=r;return i=r=void 0,u=e,a=t.apply(o,n)}function m(t){var n=t-c;return void 0===c||n>=e||n<0||f&&t-u>=o}function x(){var t=_();if(m(t))return b(t);s=setTimeout(x,function(t){var n=e-(t-c);return f?p(n,o-(t-u)):n}(t))}function b(t){return s=void 0,h&&i?g(t):(i=r=void 0,a)}function w(){var t=_(),n=m(t);if(i=arguments,r=this,c=t,n){if(void 0===s)return function(t){return u=t,s=setTimeout(x,e),l?g(t):a}(c);if(f)return s=setTimeout(x,e),g(c)}return void 0===s&&(s=setTimeout(x,e)),a}return e=v(e)||0,y(n)&&(l=!!n.leading,o=(f="maxWait"in n)?d(v(n.maxWait)||0,e):o,h="trailing"in n?!!n.trailing:h),w.cancel=function(){void 0!==s&&clearTimeout(s),u=0,i=c=r=s=void 0},w.flush=function(){return void 0===s?a:b(_())},w}}).call(this,n(7))},function(t,e,n){"use strict";var i=h(n(19)),r=h(n(18)),o=h(n(6)),a=h(n(4)),s=h(n(3)),c=h(n(2)),u=h(n(12)),l=h(n(10)),f=h(n(0));function h(t){return t&&t.__esModule?t:{default:t}}var d=d3.select("body"),p=0;d.classed("is-mobile",r.default.any()),window.addEventListener("resize",(0,i.default)(function(){var t=d.node().offsetWidth;p!==t&&(p=t,o.default.resize(),s.default.resize(),a.default.resize(),c.default.resize())},150)),function(){if(d.select("header").classed("is-sticky")){var t=d.select(".header__menu"),e=d.select(".header__toggle");e.on("click",function(){var n=t.classed("is-visible");t.classed("is-visible",!n),e.classed("is-visible",!n)})}}(),d3.loadData("assets/data/people.csv",function(t,e){var n=f.default.people(e[0]);o.default.init(n),s.default.init(n),a.default.init(n),c.default.init(n),(0,l.default)({name:"Industry",data:n}),(0,l.default)({name:"Cause",data:n}),(0,u.default)(n)})}]);